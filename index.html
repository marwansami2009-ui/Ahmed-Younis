<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ Ù„Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª | Ø£/ Ø£Ø­Ù…Ø¯ Ø³Ø¹Ø¯ ÙŠÙˆÙ†Ø³</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Firebase Initialization - SINGLE INSTANCE -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getDatabase, ref, set, get, child, push, update, onValue, remove, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAWvMBrjkjU02jfOe8HKNnDHNx1ZshlDdo",
            authDomain: "el-alamy-platform.firebaseapp.com",
            databaseURL: "https://el-alamy-platform-default-rtdb.firebaseio.com",
            projectId: "el-alamy-platform",
            storageBucket: "el-alamy-platform.firebasestorage.app",
            messagingSenderId: "790950981758",
            appId: "1:790950981758:web:21cf7c65e9d2cce210a82f",
            measurementId: "G-970BP0VKQQ"
        };

        const app = initializeApp(firebaseConfig);
        window.db = getDatabase(app); 
        window.auth = getAuth(app);
        window.googleProvider = new GoogleAuthProvider();
        
        window.rtdb = { ref, set, get, child, push, update, onValue, remove, serverTimestamp };
        window.authMethods = { signInWithPopup, signOut, onAuthStateChanged };
        
        console.log('âœ… Firebase initialized successfully');
    </script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { 
                        brand: {
                            dark: '#0f172a',
                            card: '#1e293b',
                            primary: '#3b82f6',
                            accent: '#fbbf24',
                            gold: '#FFD700',
                            silver: '#C0C0C0',
                            bronze: '#CD7F32',
                            success: '#10b981',
                            warning: '#f59e0b',
                            danger: '#ef4444'
                        }
                    },
                    fontFamily: { 'cairo': ['Cairo', 'sans-serif'] },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'slide-up': 'slideUp 0.8s ease-out',
                        'pulse-glow': 'pulseGlow 2s ease-in-out infinite',
                        'bounce-slow': 'bounceSlow 3s infinite'
                    },
                    keyframes: {
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-20px)' } },
                        slideUp: { '0%': { transform: 'translateY(30px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        pulseGlow: { '0%, 100%': { opacity: '1' }, '50%': { opacity: '0.7' } },
                        bounceSlow: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } }
                    }
                }
            }
        }
    </script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
        
        * { box-sizing: border-box; }
        body { font-family: 'Cairo', sans-serif; background-color: #0f172a; color: white; overflow-x: hidden; margin: 0; }
        
        .glass-panel { 
            background: rgba(30, 41, 59, 0.85); 
            backdrop-filter: blur(16px); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            border-radius: 16px;
        }

        .btn-main {
            background: linear-gradient(135deg, #fbbf24 0%, #d97706 100%);
            color: #0f172a;
            font-weight: 800;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3);
        }
        .btn-main:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(251, 191, 36, 0.5); }
        
        .embed-wrapper { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 12px; background: #000; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .embed-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
        
        .math-grid {
            background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
        }
        
        .hero-glow {
            background: radial-gradient(circle at 50% 50%, rgba(59, 130, 246, 0.15) 0%, transparent 50%);
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #fbbf24; }

        .quiz-option {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .quiz-option:hover {
            transform: translateX(-5px);
            border-color: #fbbf24;
        }
        .quiz-option.selected {
            background: rgba(251, 191, 36, 0.2);
            border-color: #fbbf24;
        }

        .rank-gold { background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.05)); border: 1px solid rgba(255, 215, 0, 0.3); }
        .rank-silver { background: linear-gradient(135deg, rgba(192, 192, 192, 0.2), rgba(192, 192, 192, 0.05)); border: 1px solid rgba(192, 192, 192, 0.3); }
        .rank-bronze { background: linear-gradient(135deg, rgba(205, 127, 50, 0.2), rgba(205, 127, 50, 0.05)); border: 1px solid rgba(205, 127, 50, 0.3); }
        
        .loader {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top: 4px solid #fbbf24;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .role-badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
        }
        .badge-student { background: rgba(59, 130, 246, 0.2); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.3); }
        .badge-parent { background: rgba(16, 185, 129, 0.2); color: #34d399; border: 1px solid rgba(16, 185, 129, 0.3); }
        .badge-admin { background: rgba(245, 158, 11, 0.2); color: #fbbf24; border: 1px solid rgba(245, 158, 11, 0.3); }
        .badge-boss { background: rgba(239, 68, 68, 0.2); color: #f87171; border: 1px solid rgba(239, 68, 68, 0.3); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // ğŸ” SUPER ADMIN EMAIL - HARDCODED
        const SUPER_ADMIN_EMAIL = 'marwansami2009@gmail.com';

        // ğŸ“± Contact Info
        const CONTACT_INFO = {
            whatsapp: 'https://wa.me/201000000000',
            facebook: 'https://facebook.com/yourpage',
            youtube: 'https://youtube.com/yourchannel',
            telegram: 'https://t.me/yourchannel',
            vodafoneNumber: '010xxxxxxxx',
            supportWhatsapp: 'https://wa.me/201000000000',
            masterWhatsapp: 'https://wa.me/201111111111'
        };

        // ğŸ›¡ï¸ SafeIcon Component
        const SafeIcon = ({ name, size = 20, className = '' }) => {
            const icons = {
                'home': 'ğŸ ', 'video': 'ğŸ¬', 'play-circle': 'â–¶ï¸', 'credit-card': 'ğŸ’³',
                'help-circle': 'â“', 'gift': 'ğŸ', 'trending-up': 'ğŸ“ˆ', 'calendar-check': 'ğŸ“…',
                'bell': 'ğŸ””', 'message-circle': 'ğŸ’¬', 'calculator': 'ğŸ§®', 'user': 'ğŸ‘¤',
                'key': 'ğŸ”‘', 'clock': 'â°', 'send': 'ğŸ“¤', 'log-in': 'â†ªï¸', 'menu': 'â˜°',
                'x': 'âœ–ï¸', 'check': 'âœ“', 'check-circle': 'âœ…', 'alert-circle': 'âš ï¸',
                'trash-2': 'ğŸ—‘ï¸', 'arrow-right': 'â†’', 'arrow-left': 'â†', 'lock': 'ğŸ”’',
                'unlock': 'ğŸ”“', 'star': 'â­', 'lightbulb': 'ğŸ’¡', 'mail': 'âœ‰ï¸',
                'phone': 'ğŸ“', 'book-open': 'ğŸ“–', 'file-text': 'ğŸ“„', 'image': 'ğŸ–¼ï¸',
                'headphones': 'ğŸ§', 'settings': 'âš™ï¸', 'facebook': 'f', 'youtube': 'â–¶',
                'instagram': 'ğŸ“·', 'users': 'ğŸ‘¥', 'shield': 'ğŸ›¡ï¸', 'eye': 'ğŸ‘ï¸',
                'eye-off': 'ğŸ‘ï¸â€ğŸ—¨ï¸', 'link': 'ğŸ”—', 'parent': 'ğŸ‘¨â€ğŸ‘¦', 'student': 'ğŸ‘¨â€ğŸ“',
                'admin': 'ğŸ‘¨â€ğŸ’¼', 'logout': 'ğŸšª', 'search': 'ğŸ”', 'filter': 'âš™ï¸',
                'download': 'â¬‡ï¸', 'upload': 'â¬†ï¸', 'edit': 'âœï¸', 'copy': 'ğŸ“‹',
                'crown': 'ğŸ‘‘', 'user-plus': 'â•ğŸ‘¤', 'user-minus': 'â–ğŸ‘¤'
            };
            
            const emoji = icons[name] || 'ğŸ”¹';
            
            return (
                <span 
                    style={{ 
                        fontSize: `${size * 0.7}px`,
                        display: 'inline-block',
                        width: `${size}px`,
                        height: `${size}px`,
                        lineHeight: 1
                    }}
                    className={className}
                >
                    {emoji}
                </span>
            );
        };

        // ğŸ›¡ï¸ Error Boundary
        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false, error: null };
            }
            
            static getDerivedStateFromError(error) {
                return { hasError: true, error };
            }
            
            componentDidCatch(error, errorInfo) {
                console.error('App Error:', error, errorInfo);
            }
            
            render() {
                if (this.state.hasError) {
                    return (
                        <div className="min-h-screen bg-brand-dark flex items-center justify-center p-4">
                            <div className="glass-panel p-8 text-center">
                                <div className="text-6xl mb-4">âš ï¸</div>
                                <h2 className="text-2xl font-bold text-red-400 mb-2">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h2>
                                <p className="text-slate-400 mb-4">Ø³ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹...</p>
                                <button 
                                    onClick={() => window.location.reload()}
                                    className="btn-main px-6 py-3 rounded-xl"
                                >
                                    Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„
                                </button>
                            </div>
                        </div>
                    );
                }
                return this.props.children;
            }
        }

        const App = () => {
            // --- State Management ---
            const [user, setUser] = useState(null); 
            const [view, setView] = useState('landing'); 
            const [registrationType, setRegistrationType] = useState(null);
            const [dataState, setDataState] = useState({ 
                students: [], 
                parents: [], 
                requests: [], 
                lectures: [], 
                whiteboards: [], 
                qa: [], 
                exams: [], 
                announcements: [], 
                payments: [], 
                subscriptions: {},
                freeContent: [], 
                attendance: {}, 
                performance: {}, 
                weeklyAssessments: {},
                parentConnections: {}
            });
            
            // Registration Data
            const [studentRegData, setStudentRegData] = useState({ 
                firstName: '', secondName: '', thirdName: '', phone: '', parentPhone: '', 
                school: '', governorate: '', city: '', center: '', grade: '1sec',
                address: '', scheduleDays: 'Ø§Ù„Ø§Ø«Ù†ÙŠÙ† ÙˆØ§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡'
            });
            
            const [parentRegData, setParentRegData] = useState({
                name: '', phone: '', email: '', relationship: 'Ø£Ø¨',
                studentsCount: 1, notes: ''
            });
            
            const [studentLoginCode, setStudentLoginCode] = useState('');
            const [parentLoginCode, setParentLoginCode] = useState('');
            
            // UI States
            const [activeTab, setActiveTab] = useState('home');
            const [sidebarOpen, setSidebarOpen] = useState(false);
            const [notification, setNotification] = useState(null);
            const [showStudentModal, setShowStudentModal] = useState(false);
            const [selectedStudent, setSelectedStudent] = useState(null);
            const [searchQuery, setSearchQuery] = useState('');
            const [isGuestMode, setIsGuestMode] = useState(false);
            const [linkedStudents, setLinkedStudents] = useState([]);
            const [parentView, setParentView] = useState('overview');
            const [staffSearchQuery, setStaffSearchQuery] = useState('');

            const showNotification = (message, type = 'success') => {
                setNotification({ message, type });
                setTimeout(() => setNotification(null), 4000);
            };

            // --- Helper Functions ---
            const generateRandomCode = (prefix) => {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                let code = prefix + '-';
                for (let i = 0; i < 8; i++) {
                    code += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return code;
            };

            const generateStudentCode = () => generateRandomCode('STU');
            const generateParentCode = () => generateRandomCode('PAR');

            const calculateSubscriptionDays = (subscriptionEnd) => {
                if (!subscriptionEnd) return 0;
                const now = new Date();
                const end = new Date(subscriptionEnd);
                const diffTime = end - now;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                return diffDays > 0 ? diffDays : 0;
            };

            // --- ğŸ” SUPER ADMIN AUTO-PROMOTION ---
            const checkAndPromoteSuperAdmin = async (authUser) => {
                if (authUser.email === SUPER_ADMIN_EMAIL) {
                    console.log('ğŸ” Super Admin detected:', SUPER_ADMIN_EMAIL);
                    
                    const userRef = window.rtdb.ref(window.db, `users/${authUser.uid}`);
                    const snapshot = await window.rtdb.get(userRef);
                    
                    const userData = {
                        uid: authUser.uid,
                        email: authUser.email,
                        name: authUser.displayName || 'The Boss',
                        photo: authUser.photoURL,
                        role: 'boss',
                        adminLevel: 'Ø§Ù„Ø¨ÙˆØµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ',
                        isNew: false,
                        promotedAt: new Date().toISOString()
                    };
                    
                    await window.rtdb.set(userRef, userData);
                    
                    return userData;
                }
                return null;
            };

            // --- Authentication Handler ---
            useEffect(() => {
                window.authMethods.onAuthStateChanged(window.auth, async (authUser) => {
                    if (authUser) {
                        console.log('ğŸ”‘ User authenticated:', authUser.email);
                        
                        // Check for Super Admin first
                        const superAdminData = await checkAndPromoteSuperAdmin(authUser);
                        
                        if (superAdminData) {
                            setUser(superAdminData);
                            setView('admin');
                            showNotification(`Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø§Ù„Ø¨ÙˆØµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ! ğŸ‘‘`, 'success');
                            return;
                        }
                        
                        // Check existing user in database
                        const userRef = window.rtdb.ref(window.db, `users/${authUser.uid}`);
                        const snapshot = await window.rtdb.get(userRef);
                        
                        if (snapshot.exists()) {
                            const userData = snapshot.val();
                            setUser({ ...userData, uid: authUser.uid, photo: authUser.photoURL });
                            
                            // Route based on role
                            if (['admin', 'boss'].includes(userData.role)) {
                                setView('admin');
                            } else if (userData.role === 'parent') {
                                setView('parent');
                                loadLinkedStudents(userData.uid);
                            } else if (userData.role === 'student') {
                                if (userData.status === 'pending') {
                                    setView('pending-approval');
                                } else {
                                    setView('student');
                                }
                            } else {
                                setView('choose-role');
                            }
                        } else {
                            // New user
                            setUser({ 
                                uid: authUser.uid, 
                                name: authUser.displayName, 
                                email: authUser.email, 
                                photo: authUser.photoURL, 
                                isNew: true 
                            });
                            setView('choose-role');
                        }
                    } else {
                        setUser(null);
                        setView('landing');
                    }
                });
            }, []);

            // --- Load Linked Students for Parents ---
            const loadLinkedStudents = async (parentId) => {
                try {
                    const connectionsRef = window.rtdb.ref(window.db, `parentConnections/${parentId}`);
                    const snapshot = await window.rtdb.get(connectionsRef);
                    
                    if (snapshot.exists()) {
                        const connections = snapshot.val();
                        const studentIds = Object.keys(connections);
                        
                        const studentsPromises = studentIds.map(async (studentId) => {
                            const studentRef = window.rtdb.ref(window.db, `users/${studentId}`);
                            const studentSnap = await window.rtdb.get(studentRef);
                            if (studentSnap.exists()) {
                                return { id: studentId, ...studentSnap.val() };
                            }
                            return null;
                        });
                        
                        const students = (await Promise.all(studentsPromises)).filter(s => s !== null);
                        setLinkedStudents(students);
                        
                        setDataState(prev => ({
                            ...prev,
                            parentConnections: {
                                ...prev.parentConnections,
                                [parentId]: connections
                            }
                        }));
                    }
                } catch (error) {
                    console.error('Error loading linked students:', error);
                }
            };

            // --- Link Student to Parent ---
            const linkStudentToParent = async (parentId, studentId, relationship = 'Ø§Ø¨Ù†/Ø§Ø¨Ù†Ø©') => {
                try {
                    const connectionRef = window.rtdb.ref(window.db, `parentConnections/${parentId}/${studentId}`);
                    await window.rtdb.set(connectionRef, {
                        linkedAt: new Date().toISOString(),
                        relationship: relationship,
                        canViewDetails: true,
                        canViewProgress: true,
                        canViewAttendance: true,
                        canViewGrades: true
                    });
                    
                    showNotification('ØªÙ… Ø±Ø¨Ø· Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± Ø¨Ù†Ø¬Ø§Ø­');
                    loadLinkedStudents(parentId);
                } catch (error) {
                    console.error('Error linking student:', error);
                    showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø±Ø¨Ø·', 'error');
                }
            };

            // --- Data Sync ---
            useEffect(() => {
                if (user || isGuestMode) {
                    // Sync lectures for all users
                    window.rtdb.onValue(window.rtdb.ref(window.db, 'lectures'), s => 
                        setDataState(p => ({ 
                            ...p, 
                            lectures: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })).sort((a, b) => (b.ts || 0) - (a.ts || 0)) : [] 
                        }))
                    );
                    
                    window.rtdb.onValue(window.rtdb.ref(window.db, 'freeContent'), s => 
                        setDataState(p => ({ 
                            ...p, 
                            freeContent: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })).sort((a, b) => (b.ts || 0) - (a.ts || 0)) : [] 
                        }))
                    );
                    
                    window.rtdb.onValue(window.rtdb.ref(window.db, 'qa'), s => 
                        setDataState(p => ({ 
                            ...p, 
                            qa: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })).sort((a, b) => (b.ts || 0) - (a.ts || 0)) : [] 
                        }))
                    );
                    
                    window.rtdb.onValue(window.rtdb.ref(window.db, 'announcements'), s => 
                        setDataState(p => ({ 
                            ...p, 
                            announcements: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })).sort((a, b) => (b.ts || 0) - (a.ts || 0)) : [] 
                        }))
                    );
                    
                    if (user && ['admin', 'boss'].includes(user.role)) {
                        window.rtdb.onValue(window.rtdb.ref(window.db, 'requests'), s => 
                            setDataState(p => ({ ...p, requests: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })) : [] }))
                        );
                        
                        window.rtdb.onValue(window.rtdb.ref(window.db, 'users'), s => {
                            const allUsers = s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })) : [];
                            setDataState(p => ({ 
                                ...p, 
                                students: allUsers.filter(u => u.role === 'student'),
                                parents: allUsers.filter(u => u.role === 'parent')
                            }));
                        });
                        
                        window.rtdb.onValue(window.rtdb.ref(window.db, 'payments'), s => 
                            setDataState(p => ({ ...p, payments: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })) : [] }))
                        );
                        
                        window.rtdb.onValue(window.rtdb.ref(window.db, 'subscriptions'), s => 
                            setDataState(p => ({ ...p, subscriptions: s.val() || {} }))
                        );
                        
                        window.rtdb.onValue(window.rtdb.ref(window.db, 'attendance'), s => 
                            setDataState(p => ({ ...p, attendance: s.val() || {} }))
                        );
                    }
                }
            }, [user, isGuestMode]);

            // --- Registration Handlers ---
            const submitRegistration = async (type) => {
                let data, collection;
                
                if (type === 'student') {
                    const required = ['firstName', 'secondName', 'phone', 'parentPhone', 'school', 'grade'];
                    const missing = required.filter(field => !studentRegData[field]);
                    
                    if (missing.length > 0) {
                        return showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§ÙƒØªØ¨ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (*)', 'error');
                    }
                    
                    const fullName = `${studentRegData.firstName} ${studentRegData.secondName} ${studentRegData.thirdName || ''}`.trim();
                    const studentCode = generateStudentCode();
                    
                    data = { 
                        ...studentRegData, 
                        name: fullName,
                        uid: user.uid, 
                        email: user.email, 
                        photo: user.photo, 
                        code: studentCode,
                        role: 'student',
                        status: 'pending',
                        date: new Date().toLocaleDateString(),
                        ts: Date.now()
                    };
                    
                    collection = 'requests';
                } else if (type === 'parent') {
                    const required = ['name', 'phone'];
                    const missing = required.filter(field => !parentRegData[field]);
                    
                    if (missing.length > 0) {
                        return showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§ÙƒØªØ¨ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (*)', 'error');
                    }
                    
                    const parentCode = generateParentCode();
                    
                    data = {
                        ...parentRegData,
                        uid: user.uid,
                        email: user.email,
                        photo: user.photo,
                        code: parentCode,
                        role: 'parent',
                        status: 'pending',
                        date: new Date().toLocaleDateString(),
                        ts: Date.now()
                    };
                    
                    collection = 'parentRequests';
                } else {
                    return;
                }
                
                await window.rtdb.set(window.rtdb.push(window.rtdb.ref(window.db, collection)), data);
                showNotification(`ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ ${type === 'student' ? 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨' : 'ØªØ³Ø¬ÙŠÙ„ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±'}!`);
                
                setTimeout(() => {
                    setView('pending-approval');
                }, 2000);
            };

            // --- Student Login ---
            const handleStudentLogin = async () => {
                if (studentLoginCode.length < 3) {
                    return showNotification('Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ', 'error');
                }
                
                const student = dataState.students.find(s => s.code === studentLoginCode);
                if (student) {
                    if (student.status === 'pending') {
                        setView('pending-approval');
                    } else {
                        setUser({ ...student, uid: student.id });
                        setView('student');
                        showNotification(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${student.firstName} ${student.secondName}!`);
                    }
                } else {
                    showNotification('Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
                }
            };

            // --- Parent Login ---
            const handleParentLogin = async () => {
                if (parentLoginCode.length < 3) {
                    return showNotification('Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ', 'error');
                }
                
                const parent = dataState.parents.find(p => p.code === parentLoginCode);
                if (parent) {
                    setUser({ ...parent, uid: parent.id });
                    setView('parent');
                    showNotification(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${parent.name}!`);
                } else {
                    showNotification('Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
                }
            };

            // --- Update Student ---
            const updateStudent = async (id, data) => {
                try {
                    await window.rtdb.update(window.rtdb.ref(window.db, `users/${id}`), data);
                    showNotification('ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« ğŸ‘Œ');
                    
                    setDataState(prev => ({
                        ...prev,
                        students: prev.students.map(s => 
                            s.id === id ? { ...s, ...data } : s
                        )
                    }));
                } catch (error) {
                    console.error('Error updating student:', error);
                    showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«', 'error');
                }
            };

            // --- ğŸ‘‘ STAFF MANAGEMENT FUNCTIONS ---
            const promoteToAdmin = async (studentId) => {
                try {
                    const student = dataState.students.find(s => s.id === studentId);
                    if (!student) return;
                    
                    if (!confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ±Ù‚ÙŠØ© ${student.name} Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯ Ø¥Ø¯Ø§Ø±ÙŠØŸ`)) return;
                    
                    await window.rtdb.update(window.rtdb.ref(window.db, `users/${studentId}`), {
                        role: 'admin',
                        promotedAt: new Date().toISOString(),
                        promotedBy: user.uid
                    });
                    
                    showNotification(`ØªÙ… ØªØ±Ù‚ÙŠØ© ${student.name} Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯ Ø¥Ø¯Ø§Ø±ÙŠ ğŸ‘¨â€ğŸ’¼`, 'success');
                } catch (error) {
                    console.error('Error promoting to admin:', error);
                    showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ±Ù‚ÙŠØ©', 'error');
                }
            };

            const demoteToStudent = async (adminId) => {
                try {
                    const admin = dataState.students.find(s => s.id === adminId);
                    if (!admin) return;
                    
                    // Prevent demoting the boss
                    if (admin.role === 'boss') {
                        return showNotification('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø·Ø±Ø¯ Ø§Ù„Ø¨ÙˆØµ!', 'error');
                    }
                    
                    if (!confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø·Ø±Ø¯ ${admin.name} Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ¥Ø¹Ø§Ø¯ØªÙ‡ Ø·Ø§Ù„Ø¨ Ø¹Ø§Ø¯ÙŠØŸ`)) return;
                    
                    await window.rtdb.update(window.rtdb.ref(window.db, `users/${adminId}`), {
                        role: 'student',
                        demotedAt: new Date().toISOString(),
                        demotedBy: user.uid
                    });
                    
                    showNotification(`ØªÙ… Ø·Ø±Ø¯ ${admin.name} Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©`, 'success');
                } catch (error) {
                    console.error('Error demoting admin:', error);
                    showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø·Ø±Ø¯', 'error');
                }
            };

            // --- Guest Mode ---
            const handleGuestMode = () => {
                setIsGuestMode(true);
                setView('guest');
                showNotification('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙƒØ²Ø§Ø¦Ø±! ÙŠÙ…ÙƒÙ†Ùƒ ØªØµÙØ­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ', 'info');
            };

            // ğŸ¨ Landing Page
            if (view === 'landing') return (
                <div className="min-h-screen bg-brand-dark text-white relative overflow-hidden math-grid flex flex-col">
                    <div className="absolute top-0 left-0 w-full h-full hero-glow z-0"></div>
                    
                    <header className="relative z-50 p-6 flex justify-between items-center container mx-auto">
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 bg-brand-accent rounded-lg flex items-center justify-center text-brand-dark font-black text-xl">âˆ‘</div>
                            <h1 className="text-2xl font-black tracking-tighter">Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</h1>
                        </div>
                        <div className="flex gap-3 flex-wrap">
                            <button onClick={()=>window.authMethods.signInWithPopup(window.auth, window.googleProvider)} 
                                    className="bg-white/10 hover:bg-white/20 border border-white/20 px-6 py-2 rounded-full font-bold transition text-sm">
                                ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
                            </button>
                            <button onClick={()=>{
                                setRegistrationType('student');
                                setView('registration');
                            }} 
                                    className="bg-blue-600/20 hover:bg-blue-600/40 border border-blue-500/30 px-6 py-2 rounded-full font-bold transition text-sm">
                                ØªØ³Ø¬ÙŠÙ„ Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
                            </button>
                            <button onClick={()=>{
                                setRegistrationType('parent');
                                setView('registration');
                            }}
                                    className="bg-green-600/20 hover:bg-green-600/40 border border-green-500/30 px-6 py-2 rounded-full font-bold transition text-sm">
                                ØªØ³Ø¬ÙŠÙ„ ÙˆÙ„ÙŠ Ø£Ù…Ø±
                            </button>
                            <button onClick={handleGuestMode}
                                    className="bg-purple-600/20 hover:bg-purple-600/40 border border-purple-500/30 px-6 py-2 rounded-full font-bold transition text-sm">
                                ØªØµÙØ­ ÙƒØ²Ø§Ø¦Ø±
                            </button>
                        </div>
                    </header>

                    <div className="flex-1 container mx-auto px-4 flex flex-col-reverse md:flex-row items-center justify-center gap-10 relative z-20 py-10">
                        <div className="text-center md:text-right space-y-6 md:w-1/2 animate-slide-up">
                            <div className="inline-block bg-blue-500/20 text-blue-300 px-4 py-1 rounded-full text-sm font-bold border border-blue-500/30">
                                ğŸš€ Ø£Ù‚ÙˆÙ‰ Ù…Ù†ØµØ© Ø±ÙŠØ§Ø¶ÙŠØ§Øª ÙÙŠ Ù…ØµØ±
                            </div>
                            
                            <h1 className="text-5xl md:text-7xl font-black leading-tight">
                                Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª<br/>
                                <span className="text-brand-accent">Ù„Ø¹Ø¨ØªÙƒ Ù…Ø¹Ø§Ù†Ø§!</span>
                            </h1>
                            
                            <p className="text-slate-300 text-lg md:text-xl font-medium max-w-lg mx-auto md:mx-0">
                                Ù…Ø¹ Ø£/ Ø£Ø­Ù…Ø¯ Ø³Ø¹Ø¯ ÙŠÙˆÙ†Ø³.. Ø§Ù„ØªÙØ§Ø¶Ù„ ÙˆØ§Ù„ØªÙƒØ§Ù…Ù„ ÙˆØ§Ù„Ø¬Ø¨Ø± Ø¨Ù‚ÙˆØ§ Ø£Ø³Ù‡Ù„ Ù…Ù…Ø§ ØªØªØ®ÙŠÙ„. 
                                Ø´Ø±Ø­ØŒ Ø­Ù„ØŒ Ù…ØªØ§Ø¨Ø¹Ø©ØŒ ÙˆØ§Ù…ØªØ­Ø§Ù†Ø§Øª Ø¯ÙˆØ±ÙŠØ© ØªØ¶Ù…Ù†Ù„Ùƒ Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©.
                            </p>
                            
                            <div className="flex flex-col sm:flex-row gap-4 justify-center md:justify-start pt-4">
                                <button onClick={()=>window.authMethods.signInWithPopup(window.auth, window.googleProvider)} 
                                        className="btn-main px-8 py-4 rounded-xl text-xl flex items-center justify-center gap-2">
                                    Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù† <SafeIcon name="calculator"/>
                                </button>
                            </div>
                            
                            <div className="pt-6">
                                <p className="text-slate-400 mb-3">Ø£Ùˆ Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ù…Ø¨Ø§Ø´Ø±:</p>
                                <div className="flex gap-3 justify-center md:justify-start">
                                    <button onClick={()=>setView('student-login')} 
                                            className="px-4 py-2 bg-blue-500/20 hover:bg-blue-500/40 border border-blue-500/30 rounded-lg">
                                        Ø¯Ø®ÙˆÙ„ Ø·Ø§Ù„Ø¨
                                    </button>
                                    <button onClick={()=>setView('parent-login')} 
                                            className="px-4 py-2 bg-green-500/20 hover:bg-green-500/40 border border-green-500/30 rounded-lg">
                                        Ø¯Ø®ÙˆÙ„ ÙˆÙ„ÙŠ Ø£Ù…Ø±
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="md:w-1/2 relative flex justify-center items-end">
                            <div className="absolute inset-0 bg-brand-primary/30 blur-[100px] rounded-full"></div>
                            <img src="./alalamy.png" 
                                 className="relative z-10 w-full max-w-md object-contain drop-shadow-2xl animate-float hover:scale-105 transition-transform duration-500" 
                                 alt="Ø£/ Ø£Ø­Ù…Ø¯ Ø³Ø¹Ø¯ ÙŠÙˆÙ†Ø³" 
                                 onError={(e)=>{e.target.style.display='none'}}/>
                        </div>
                    </div>
                </div>
            );

            // ğŸ“ Choose Role Page
            if (view === 'choose-role') return (
                <div className="min-h-screen bg-brand-dark flex items-center justify-center p-4">
                    <div className="glass-panel p-8 w-full max-w-2xl animate-slide-up">
                        <div className="text-center mb-8">
                            <img src={user.photo} className="w-20 h-20 rounded-full mx-auto mb-4 border-4 border-brand-accent"/>
                            <h2 className="text-3xl font-bold text-white mb-2">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ! ğŸ‘‹</h2>
                            <p className="text-slate-400">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø°ÙŠ ØªØ±ØºØ¨ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¦Ù‡</p>
                        </div>

                        <div className="grid md:grid-cols-2 gap-6">
                            <div className="bg-blue-500/10 border border-blue-500/30 p-6 rounded-xl text-center hover:border-blue-500/50 transition cursor-pointer" onClick={()=>{
                                setRegistrationType('student');
                                setView('registration');
                            }}>
                                <div className="w-20 h-20 bg-blue-500/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <SafeIcon name="student" size={40} className="text-blue-400"/>
                                </div>
                                <h3 className="text-xl font-bold mb-2">Ø­Ø³Ø§Ø¨ Ø·Ø§Ù„Ø¨</h3>
                                <p className="text-slate-400 text-sm mb-4">Ù„Ù„Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ ÙˆØ§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ù…Ù†ØµØ©</p>
                            </div>

                            <div className="bg-green-500/10 border border-green-500/30 p-6 rounded-xl text-center hover:border-green-500/50 transition cursor-pointer" onClick={()=>{
                                setRegistrationType('parent');
                                setView('registration');
                            }}>
                                <div className="w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <SafeIcon name="parent" size={40} className="text-green-400"/>
                                </div>
                                <h3 className="text-xl font-bold mb-2">Ø­Ø³Ø§Ø¨ ÙˆÙ„ÙŠ Ø£Ù…Ø±</h3>
                                <p className="text-slate-400 text-sm mb-4">Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø£Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</p>
                            </div>
                        </div>

                        <div className="mt-8 text-center">
                            <button onClick={()=>window.authMethods.signOut(window.auth)} 
                                    className="text-slate-400 hover:text-white">
                                Ø§Ù„Ø±Ø¬ÙˆØ¹ ÙˆØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
                            </button>
                        </div>
                    </div>
                </div>
            );

            // ğŸ“ Registration Page
            if (view === 'registration') return (
                <div className="min-h-screen bg-brand-dark flex items-center justify-center p-4">
                    <div className="glass-panel p-8 w-full max-w-2xl animate-slide-up">
                        <div className="text-center mb-8">
                            <div className="w-20 h-20 bg-brand-accent/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                <SafeIcon name={registrationType === 'student' ? 'student' : 'parent'} size={40} className="text-brand-accent"/>
                            </div>
                            <h2 className="text-3xl font-bold text-white mb-2">
                                {registrationType === 'student' ? 'ØªØ³Ø¬ÙŠÙ„ Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯' : 'ØªØ³Ø¬ÙŠÙ„ ÙˆÙ„ÙŠ Ø£Ù…Ø±'}
                            </h2>
                            <p className="text-slate-400">Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©</p>
                        </div>

                        {registrationType === 'student' ? (
                            <div className="space-y-4">
                                <div className="grid md:grid-cols-3 gap-4">
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ *" 
                                        onChange={e=>setStudentRegData({...studentRegData, firstName: e.target.value})}
                                    />
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ *" 
                                        onChange={e=>setStudentRegData({...studentRegData, secondName: e.target.value})}
                                    />
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ø§Ù„Ø«" 
                                        onChange={e=>setStudentRegData({...studentRegData, thirdName: e.target.value})}
                                    />
                                </div>

                                <div className="grid md:grid-cols-2 gap-4">
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø±Ù‚Ù… ØªÙ„ÙŠÙÙˆÙ†Ùƒ ğŸ“± *" 
                                        onChange={e=>setStudentRegData({...studentRegData, phone: e.target.value})}
                                    />
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø±Ù‚Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ *" 
                                        onChange={e=>setStudentRegData({...studentRegData, parentPhone: e.target.value})}
                                    />
                                </div>

                                <input 
                                    className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                    placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ğŸ« *" 
                                    onChange={e=>setStudentRegData({...studentRegData, school: e.target.value})}
                                />

                                <div className="grid md:grid-cols-2 gap-4">
                                    <select 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        onChange={e=>setStudentRegData({...studentRegData, grade: e.target.value})}
                                    >
                                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ *</option>
                                        <option value="1sec">Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                                        <option value="2sec">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                                        <option value="3sec">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                                    </select>

                                    <select 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        onChange={e=>setStudentRegData({...studentRegData, scheduleDays: e.target.value})}
                                    >
                                        <option value="">Ø£ÙŠØ§Ù… Ø§Ù„Ø­ØµØµ Ø§Ù„Ù…ÙØ¶Ù„Ø© *</option>
                                        <option value="Ø§Ù„Ø§Ø«Ù†ÙŠÙ† ÙˆØ§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡">Ø§Ù„Ø§Ø«Ù†ÙŠÙ† ÙˆØ§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option>
                                        <option value="Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡ ÙˆØ§Ù„Ø®Ù…ÙŠØ³">Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡ ÙˆØ§Ù„Ø®Ù…ÙŠØ³</option>
                                        <option value="Ø§Ù„Ø³Ø¨Øª ÙˆØ§Ù„Ø£Ø­Ø¯">Ø§Ù„Ø³Ø¨Øª ÙˆØ§Ù„Ø£Ø­Ø¯</option>
                                    </select>
                                </div>
                            </div>
                        ) : (
                            <div className="space-y-4">
                                <input 
                                    className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                    placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ *" 
                                    onChange={e=>setParentRegData({...parentRegData, name: e.target.value})}
                                />

                                <div className="grid md:grid-cols-2 gap-4">
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ğŸ“± *" 
                                        onChange={e=>setParentRegData({...parentRegData, phone: e.target.value})}
                                    />
                                    <select 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        onChange={e=>setParentRegData({...parentRegData, relationship: e.target.value})}
                                    >
                                        <option value="Ø£Ø¨">Ø£Ø¨</option>
                                        <option value="Ø£Ù…">Ø£Ù…</option>
                                        <option value="ÙˆÙ„ÙŠ Ø£Ù…Ø±">ÙˆÙ„ÙŠ Ø£Ù…Ø±</option>
                                    </select>
                                </div>
                            </div>
                        )}

                        <div className="flex gap-4 mt-6">
                            <button 
                                onClick={()=>submitRegistration(registrationType)} 
                                className="btn-main flex-1 py-4 rounded-xl text-lg font-bold flex items-center justify-center gap-2"
                            >
                                <SafeIcon name="send"/> Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                            </button>
                            <button 
                                onClick={()=>setView('choose-role')} 
                                className="px-6 py-4 bg-white/10 hover:bg-white/20 rounded-xl font-bold transition"
                            >
                                Ø±Ø¬ÙˆØ¹
                            </button>
                        </div>
                    </div>
                </div>
            );

            // ğŸ” Student Login Page
            if (view === 'student-login') return (
                <div className="min-h-screen bg-brand-dark flex items-center justify-center p-4">
                    <div className="glass-panel p-8 w-full max-w-md animate-slide-up">
                        <div className="text-center mb-8">
                            <div className="w-20 h-20 bg-blue-600/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                <SafeIcon name="student" size={40} className="text-blue-400"/>
                            </div>
                            <h2 className="text-3xl font-bold text-white mb-2">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨</h2>
                            <p className="text-slate-400">Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ</p>
                        </div>

                        <div className="space-y-6">
                            <input 
                                className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white text-center text-xl tracking-widest font-mono" 
                                placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨" 
                                value={studentLoginCode}
                                onChange={e=>setStudentLoginCode(e.target.value.toUpperCase())}
                                maxLength="20"
                            />
                            
                            <button 
                                onClick={handleStudentLogin} 
                                className="btn-main w-full py-4 rounded-xl text-lg font-bold flex items-center justify-center gap-2"
                            >
                                <SafeIcon name="log-in"/> Ø¯Ø®ÙˆÙ„
                            </button>
                            
                            <div className="text-center">
                                <button onClick={()=>setView('landing')} 
                                        className="text-brand-accent hover:underline">
                                    Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // ğŸ” Parent Login Page
            if (view === 'parent-login') return (
                <div className="min-h-screen bg-brand-dark flex items-center justify-center p-4">
                    <div className="glass-panel p-8 w-full max-w-md animate-slide-up">
                        <div className="text-center mb-8">
                            <div className="w-20 h-20 bg-green-600/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                <SafeIcon name="parent" size={40} className="text-green-400"/>
                            </div>
                            <h2 className="text-3xl font-bold text-white mb-2">Ø¯Ø®ÙˆÙ„ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</h2>
                            <p className="text-slate-400">Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ</p>
                        </div>

                        <div className="space-y-6">
                            <input 
                                className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white text-center text-xl tracking-widest font-mono" 
                                placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±" 
                                value={parentLoginCode}
                                onChange={e=>setParentLoginCode(e.target.value.toUpperCase())}
                                maxLength="20"
                            />
                            
                            <button 
                                onClick={handleParentLogin} 
                                className="btn-main w-full py-4 rounded-xl text-lg font-bold flex items-center justify-center gap-2"
                            >
                                <SafeIcon name="log-in"/> Ø¯Ø®ÙˆÙ„
                            </button>
                            
                            <div className="text-center">
                                <button onClick={()=>setView('landing')} 
                                        className="text-brand-accent hover:underline">
                                    Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // â³ Pending Approval Page
            if (view === 'pending-approval') return (
                <div className="min-h-screen bg-brand-dark flex items-center justify-center p-4">
                    <div className="glass-panel p-8 text-center max-w-md">
                        <div className="text-6xl mb-4">â³</div>
                        <h2 className="text-2xl font-bold mb-4">Ø·Ù„Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h2>
                        <p className="text-slate-400 mb-6">Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨Ùƒ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ¥Ø®Ø·Ø§Ø±Ùƒ Ø¨Ø§Ù„Ù‚Ø¨ÙˆÙ„</p>
                        <button onClick={()=>window.authMethods.signOut(window.auth)} 
                                className="bg-red-600 px-6 py-3 rounded-xl font-bold hover:bg-red-700">
                            ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
                        </button>
                    </div>
                </div>
            );

            // ğŸ‘‘ Admin View with Staff Management
            if (view === 'admin') {
                const filteredStudents = dataState.students.filter(s => 
                    s.name?.toLowerCase().includes(searchQuery.toLowerCase()) ||
                    s.code?.toLowerCase().includes(searchQuery.toLowerCase()) ||
                    s.phone?.includes(searchQuery)
                );

                const staffFilteredUsers = dataState.students.filter(s => 
                    s.name?.toLowerCase().includes(staffSearchQuery.toLowerCase()) ||
                    s.code?.toLowerCase().includes(staffSearchQuery.toLowerCase())
                );

                return (
                    <div className="min-h-screen bg-brand-dark p-4 md:p-6">
                        <div className="max-w-7xl mx-auto glass-panel p-6 md:p-8">
                            <div className="flex flex-wrap justify-between items-center mb-8 pb-4 border-b border-white/10 gap-4">
                                <div>
                                    <h2 className="text-3xl font-black text-brand-accent">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø´Ø§Ù…Ù„Ø©</h2>
                                    <div className="flex items-center gap-3 mt-2">
                                        <span className={`role-badge ${user.role === 'boss' ? 'badge-boss' : 'badge-admin'}`}>
                                            {user.role === 'boss' ? 'ğŸ‘‘ Ø§Ù„Ø¨ÙˆØµ' : 'ğŸ‘¨â€ğŸ’¼ Ø£Ø¯Ù…Ù†'}
                                        </span>
                                        <span className="text-slate-400 text-sm">{user.name}</span>
                                    </div>
                                </div>
                                <button onClick={()=>window.authMethods.signOut(window.auth)} 
                                        className="px-4 py-2 bg-red-600 rounded-lg font-bold hover:bg-red-700">
                                    Ø®Ø±ÙˆØ¬
                                </button>
                            </div>

                            {/* Stats */}
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                                <div className="bg-white/5 p-4 rounded-xl border border-white/5">
                                    <div className="text-slate-400 text-xs mb-1">Ø§Ù„Ø·Ù„Ø§Ø¨</div>
                                    <div className="text-2xl font-black">{dataState.students.length}</div>
                                </div>
                                <div className="bg-white/5 p-4 rounded-xl border border-white/5">
                                    <div className="text-slate-400 text-xs mb-1">Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</div>
                                    <div className="text-2xl font-black text-green-400">{dataState.parents.length}</div>
                                </div>
                                <div className="bg-white/5 p-4 rounded-xl border border-white/5">
                                    <div className="text-slate-400 text-xs mb-1">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
                                    <div className="text-2xl font-black text-orange-400">{dataState.requests.length}</div>
                                </div>
                                <div className="bg-white/5 p-4 rounded-xl border border-white/5">
                                    <div className="text-slate-400 text-xs mb-1">Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª</div>
                                    <div className="text-2xl font-black text-brand-accent">{dataState.lectures.length}</div>
                                </div>
                            </div>

                            {/* Tabs */}
                            <div className="flex gap-2 mb-6 overflow-x-auto pb-2">
                                {['students', 'parents', user.role === 'boss' ? 'staff' : null, 'settings'].filter(Boolean).map(t => (
                                    <button key={t} onClick={()=>setActiveTab(t)} 
                                            className={`px-6 py-2 rounded-lg font-bold whitespace-nowrap transition ${activeTab === t ? 'bg-brand-accent text-brand-dark' : 'bg-white/5 text-slate-400 hover:bg-white/10'}`}>
                                        {t === 'students' ? 'ğŸ‘¥ Ø§Ù„Ø·Ù„Ø§Ø¨' : 
                                         t === 'parents' ? 'ğŸ‘¨â€ğŸ‘¦ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±' :
                                         t === 'staff' ? 'ğŸ‘‘ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ†' :
                                         t === 'settings' ? 'âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª' : ''}
                                    </button>
                                ))}
                            </div>

                            {/* Content */}
                            <div className="bg-brand-dark/50 p-6 rounded-2xl border border-white/5 min-h-[400px]">
                                
                                {/* Students Tab */}
                                {activeTab === 'students' && (
                                    <div>
                                        {dataState.requests.length > 0 && (
                                            <div className="mb-8 bg-orange-500/10 border border-orange-500/30 p-4 rounded-xl">
                                                <h3 className="font-bold text-orange-400 mb-3">Ø·Ù„Ø¨Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯Ø© ({dataState.requests.length})</h3>
                                                <div className="space-y-2">
                                                    {dataState.requests.map(r => (
                                                        <div key={r.id} className="flex justify-between items-center bg-black/20 p-3 rounded-lg">
                                                            <div>
                                                                <p className="font-bold">{r.name}</p>
                                                                <p className="text-xs text-slate-400">{r.phone} | {r.school}</p>
                                                            </div>
                                                            <div className="flex gap-2">
                                                                <button onClick={async()=>{
                                                                    const studentCode = generateStudentCode();
                                                                    const studentData = {
                                                                        ...r,
                                                                        role: 'student',
                                                                        code: studentCode,
                                                                        isPaid: false,
                                                                        status: 'active'
                                                                    };
                                                                    
                                                                    await window.rtdb.set(window.rtdb.ref(window.db,'users/'+r.uid), studentData);
                                                                    await window.rtdb.set(window.rtdb.ref(window.db,'requests/'+r.id), null);
                                                                    
                                                                    showNotification(`ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨: ${studentCode}`);
                                                                }} className="bg-green-600 px-3 py-1 rounded text-sm">Ù‚Ø¨ÙˆÙ„</button>
                                                                <button onClick={()=>window.rtdb.set(window.rtdb.ref(window.db,'requests/'+r.id), null)} 
                                                                        className="bg-red-600 px-3 py-1 rounded text-sm">Ø±ÙØ¶</button>
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        )}

                                        <div className="flex gap-2 mb-4">
                                            <input className="flex-1 bg-black/30 border border-white/10 p-3 rounded-xl outline-none" 
                                                   placeholder="Ø¨Ø­Ø«..." 
                                                   value={searchQuery} 
                                                   onChange={e=>setSearchQuery(e.target.value)}/>
                                        </div>

                                        <div className="space-y-2 max-h-[500px] overflow-y-auto">
                                            {filteredStudents.map(s => (
                                                <div key={s.id} className="flex justify-between items-center bg-white/5 p-4 rounded-xl hover:bg-white/10 transition">
                                                    <div className="flex items-center gap-4">
                                                        <img src={s.photo} className="w-12 h-12 rounded-full"/>
                                                        <div>
                                                            <p className="font-bold">{s.name}</p>
                                                            <p className="text-xs text-slate-400">{s.code} | {s.phone}</p>
                                                        </div>
                                                    </div>
                                                    <button onClick={()=>{setSelectedStudent(s); setShowStudentModal(true);}} 
                                                            className="px-3 py-1 bg-blue-500/20 text-blue-400 rounded">
                                                        Ø¥Ø¯Ø§Ø±Ø©
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {/* Parents Tab */}
                                {activeTab === 'parents' && (
                                    <div>
                                        <h3 className="font-bold mb-4">Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ± Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</h3>
                                        <div className="space-y-3">
                                            {dataState.parents.map(parent => (
                                                <div key={parent.id} className="bg-white/5 p-4 rounded-xl">
                                                    <div className="flex items-center gap-3">
                                                        <img src={parent.photo} className="w-12 h-12 rounded-full"/>
                                                        <div>
                                                            <p className="font-bold">{parent.name}</p>
                                                            <p className="text-xs text-slate-400">{parent.phone} | {parent.code}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {/* ğŸ‘‘ STAFF MANAGEMENT TAB - BOSS ONLY */}
                                {activeTab === 'staff' && user.role === 'boss' && (
                                    <div>
                                        <div className="bg-red-500/10 border border-red-500/30 p-4 rounded-xl mb-6">
                                            <h3 className="font-bold text-red-400 mb-2 flex items-center gap-2">
                                                <SafeIcon name="crown"/> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠÙŠÙ†
                                            </h3>
                                            <p className="text-sm text-slate-400">
                                                ÙŠÙ…ÙƒÙ†Ùƒ ØªØ±Ù‚ÙŠØ© Ø£ÙŠ Ø·Ø§Ù„Ø¨ Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯ Ø¥Ø¯Ø§Ø±ÙŠ Ø£Ùˆ Ø·Ø±Ø¯ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†
                                            </p>
                                        </div>

                                        {/* Search */}
                                        <div className="mb-6">
                                            <input 
                                                className="w-full bg-black/30 border border-white/10 p-3 rounded-xl outline-none" 
                                                placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø·Ø§Ù„Ø¨ Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„ÙƒÙˆØ¯..." 
                                                value={staffSearchQuery}
                                                onChange={e=>setStaffSearchQuery(e.target.value)}
                                            />
                                        </div>

                                        {/* Current Admins */}
                                        <div className="mb-8">
                                            <h4 className="font-bold text-yellow-400 mb-3">Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†:</h4>
                                            <div className="space-y-2">
                                                {dataState.students.filter(s => s.role === 'admin').map(admin => (
                                                    <div key={admin.id} className="flex justify-between items-center bg-yellow-500/10 border border-yellow-500/30 p-4 rounded-xl">
                                                        <div className="flex items-center gap-3">
                                                            <img src={admin.photo} className="w-12 h-12 rounded-full"/>
                                                            <div>
                                                                <p className="font-bold">{admin.name}</p>
                                                                <p className="text-xs text-slate-400">{admin.code} | {admin.email}</p>
                                                                <span className="badge-admin mt-1 inline-block">Ù…Ø³Ø§Ø¹Ø¯ Ø¥Ø¯Ø§Ø±ÙŠ</span>
                                                            </div>
                                                        </div>
                                                        <button 
                                                            onClick={()=>demoteToStudent(admin.id)}
                                                            className="px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg font-bold flex items-center gap-2"
                                                        >
                                                            <SafeIcon name="user-minus" size={16}/> Ø·Ø±Ø¯ Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                                                        </button>
                                                    </div>
                                                ))}
                                                {dataState.students.filter(s => s.role === 'admin').length === 0 && (
                                                    <p className="text-center text-slate-500 py-4">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                                                )}
                                            </div>
                                        </div>

                                        {/* All Students - Promote Options */}
                                        <div>
                                            <h4 className="font-bold text-blue-400 mb-3">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†:</h4>
                                            <div className="space-y-2 max-h-96 overflow-y-auto">
                                                {staffFilteredUsers.filter(s => s.role === 'student').map(student => (
                                                    <div key={student.id} className="flex justify-between items-center bg-white/5 p-4 rounded-xl hover:bg-white/10 transition">
                                                        <div className="flex items-center gap-3">
                                                            <img src={student.photo} className="w-12 h-12 rounded-full"/>
                                                            <div>
                                                                <p className="font-bold">{student.name}</p>
                                                                <p className="text-xs text-slate-400">{student.code} | {student.email}</p>
                                                                <span className="badge-student mt-1 inline-block">Ø·Ø§Ù„Ø¨</span>
                                                            </div>
                                                        </div>
                                                        <button 
                                                            onClick={()=>promoteToAdmin(student.id)}
                                                            className="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-bold flex items-center gap-2"
                                                        >
                                                            <SafeIcon name="user-plus" size={16}/> ØªØ±Ù‚ÙŠØ© Ø¥Ù„Ù‰ Ø£Ø¯Ù…Ù†
                                                        </button>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* Settings Tab */}
                                {activeTab === 'settings' && (
                                    <div>
                                        <h3 className="font-bold mb-4">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
                                        <div className="glass-panel p-6">
                                            <h4 className="font-bold mb-4">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h4>
                                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                                <div className="bg-white/5 p-3 rounded text-center">
                                                    <div className="text-lg font-bold">{dataState.students.length}</div>
                                                    <div className="text-xs text-slate-400">Ø·Ø§Ù„Ø¨</div>
                                                </div>
                                                <div className="bg-white/5 p-3 rounded text-center">
                                                    <div className="text-lg font-bold">{dataState.parents.length}</div>
                                                    <div className="text-xs text-slate-400">ÙˆÙ„ÙŠ Ø£Ù…Ø±</div>
                                                </div>
                                                <div className="bg-white/5 p-3 rounded text-center">
                                                    <div className="text-lg font-bold">{dataState.lectures.length}</div>
                                                    <div className="text-xs text-slate-400">Ù…Ø­Ø§Ø¶Ø±Ø©</div>
                                                </div>
                                                <div className="bg-white/5 p-3 rounded text-center">
                                                    <div className="text-lg font-bold">{dataState.students.filter(s => s.role === 'admin').length}</div>
                                                    <div className="text-xs text-slate-400">Ù…Ø³Ø§Ø¹Ø¯ Ø¥Ø¯Ø§Ø±ÙŠ</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Student Management Modal */}
                        {showStudentModal && selectedStudent && (
                            <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-4" onClick={()=>setShowStudentModal(false)}>
                                <div className="bg-brand-card p-6 rounded-2xl w-full max-w-lg border border-white/10 max-h-[90vh] overflow-y-auto" onClick={e=>e.stopPropagation()}>
                                    <h3 className="text-xl font-bold mb-4 text-brand-accent">Ø¥Ø¯Ø§Ø±Ø©: {selectedStudent.name}</h3>
                                    
                                    <div className="space-y-4">
                                        <div className="grid grid-cols-2 gap-4 text-sm">
                                            <div>
                                                <p className="text-slate-400 text-xs mb-1">Ø§Ù„ÙƒÙˆØ¯:</p>
                                                <p className="font-bold">{selectedStudent.code}</p>
                                            </div>
                                            <div>
                                                <p className="text-slate-400 text-xs mb-1">Ø§Ù„ØµÙ:</p>
                                                <p className="font-bold">{selectedStudent.grade === '1sec' ? 'Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ' : selectedStudent.grade === '2sec' ? 'Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ' : 'Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ'}</p>
                                            </div>
                                        </div>

                                        <div>
                                            <label className="text-xs text-slate-400 mb-1 block">Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</label>
                                            <textarea 
                                                className="w-full bg-black/30 border border-white/10 rounded-lg p-2 text-white h-20" 
                                                value={selectedStudent.notes || ''} 
                                                onChange={e=>setSelectedStudent({...selectedStudent, notes: e.target.value})}
                                            />
                                        </div>

                                        <div className="flex gap-2 pt-4">
                                            <button onClick={()=>{
                                                updateStudent(selectedStudent.id, {
                                                    notes: selectedStudent.notes
                                                });
                                                setShowStudentModal(false);
                                            }} className="flex-1 bg-brand-primary py-2 rounded-lg font-bold">Ø­ÙØ¸</button>
                                            <button onClick={()=>setShowStudentModal(false)} className="px-4 py-2 bg-white/10 rounded-lg font-bold">Ø¥ØºÙ„Ø§Ù‚</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                );
            }

            // Simple fallback for other views
            return (
                <div className="min-h-screen bg-brand-dark flex items-center justify-center">
                    <div className="text-center">
                        <div className="loader mx-auto mb-4"></div>
                        <p className="text-slate-400">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
                    </div>
                </div>
            );
        };

        const RootApp = () => (
            <ErrorBoundary>
                <App />
            </ErrorBoundary>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<RootApp />);
    </script>
</body>
</html>
