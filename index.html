<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ Ù„Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª | Ø£/ Ø£Ø­Ù…Ø¯ Ø³Ø¹Ø¯ ÙŠÙˆÙ†Ø³</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getDatabase, ref, set, get, child, push, update, onValue, remove, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAWvMBrjkjU02jfOe8HKNnDHNx1ZshlDdo",
            authDomain: "el-alamy-platform.firebaseapp.com",
            databaseURL: "https://el-alamy-platform-default-rtdb.firebaseio.com",
            projectId: "el-alamy-platform",
            storageBucket: "el-alamy-platform.firebasestorage.app",
            messagingSenderId: "790950981758",
            appId: "1:790950981758:web:21cf7c65e9d2cce210a82f",
            measurementId: "G-970BP0VKQQ"
        };

        const app = initializeApp(firebaseConfig);
        window.db = getDatabase(app); 
        window.auth = getAuth(app);
        window.googleProvider = new GoogleAuthProvider();
        
        window.rtdb = { ref, set, get, child, push, update, onValue, remove, serverTimestamp };
        window.authMethods = { signInWithPopup, signOut, onAuthStateChanged };
    </script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { 
                        brand: {
                            dark: '#0f172a',
                            card: '#1e293b',
                            primary: '#3b82f6',
                            accent: '#fbbf24',
                            gold: '#FFD700',
                            silver: '#C0C0C0',
                            bronze: '#CD7F32',
                            success: '#10b981',
                            warning: '#f59e0b',
                            danger: '#ef4444'
                        }
                    },
                    fontFamily: { 'cairo': ['Cairo', 'sans-serif'] },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'slide-up': 'slideUp 0.8s ease-out',
                        'pulse-glow': 'pulseGlow 2s ease-in-out infinite',
                        'bounce-slow': 'bounceSlow 3s infinite'
                    },
                    keyframes: {
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-20px)' } },
                        slideUp: { '0%': { transform: 'translateY(30px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        pulseGlow: { '0%, 100%': { opacity: '1' }, '50%': { opacity: '0.7' } },
                        bounceSlow: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
        
        * { box-sizing: border-box; }
        body { font-family: 'Cairo', sans-serif; background-color: #0f172a; color: white; overflow-x: hidden; margin: 0; }
        
        .glass-panel { 
            background: rgba(30, 41, 59, 0.85); 
            backdrop-filter: blur(16px); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            border-radius: 16px;
        }

        .btn-main {
            background: linear-gradient(135deg, #fbbf24 0%, #d97706 100%);
            color: #0f172a;
            font-weight: 800;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3);
        }
        .btn-main:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(251, 191, 36, 0.5); }
        
        .embed-wrapper { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 12px; background: #000; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .embed-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
        
        .math-grid {
            background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
        }
        
        .hero-glow {
            background: radial-gradient(circle at 50% 50%, rgba(59, 130, 246, 0.15) 0%, transparent 50%);
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #fbbf24; }

        .quiz-option {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .quiz-option:hover {
            transform: translateX(-5px);
            border-color: #fbbf24;
        }
        .quiz-option.selected {
            background: rgba(251, 191, 36, 0.2);
            border-color: #fbbf24;
        }

        .rank-gold { background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.05)); border: 1px solid rgba(255, 215, 0, 0.3); }
        .rank-silver { background: linear-gradient(135deg, rgba(192, 192, 192, 0.2), rgba(192, 192, 192, 0.05)); border: 1px solid rgba(192, 192, 192, 0.3); }
        .rank-bronze { background: linear-gradient(135deg, rgba(205, 127, 50, 0.2), rgba(205, 127, 50, 0.05)); border: 1px solid rgba(205, 127, 50, 0.3); }
        
        .loader {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top: 4px solid #fbbf24;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .attendance-btn {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .attendance-btn::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(251, 191, 36, 0.3) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .attendance-btn:hover::after {
            opacity: 1;
        }

        .role-badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
        }
        .badge-student { background: rgba(59, 130, 246, 0.2); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.3); }
        .badge-parent { background: rgba(16, 185, 129, 0.2); color: #34d399; border: 1px solid rgba(16, 185, 129, 0.3); }
        .badge-admin { background: rgba(245, 158, 11, 0.2); color: #fbbf24; border: 1px solid rgba(245, 158, 11, 0.3); }
        .badge-boss { background: rgba(239, 68, 68, 0.2); color: #f87171; border: 1px solid rgba(239, 68, 68, 0.3); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // ğŸ” Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© (ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)
        const ADMIN_CODES = {
            'BOSS': {
                code: 'BOSS-' + Math.random().toString(36).substr(2, 8).toUpperCase(),
                role: 'boss',
                name: 'Ø§Ù„Ø¨ÙˆØµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ'
            },
            'ADMIN_1': {
                code: 'ADMIN-' + Math.random().toString(36).substr(2, 8).toUpperCase(),
                role: 'admin',
                name: 'Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø£ÙˆÙ„'
            },
            'ADMIN_2': {
                code: 'ADMIN-' + Math.random().toString(36).substr(2, 8).toUpperCase(),
                role: 'admin',
                name: 'Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø«Ø§Ù†ÙŠ'
            },
            'ADMIN_3': {
                code: 'ADMIN-' + Math.random().toString(36).substr(2, 8).toUpperCase(),
                role: 'admin',
                name: 'Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø«Ø§Ù„Ø«'
            }
        };

        // Ø­ÙØ¸ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ ÙÙŠ localStorage
        localStorage.setItem('ADMIN_CODES', JSON.stringify(ADMIN_CODES));

        // ğŸ“± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„
        const CONTACT_INFO = {
            whatsapp: 'https://wa.me/201000000000',
            facebook: 'https://facebook.com/yourpage',
            youtube: 'https://youtube.com/yourchannel',
            telegram: 'https://t.me/yourchannel',
            vodafoneNumber: '010xxxxxxxx',
            supportWhatsapp: 'https://wa.me/201000000000',
            masterWhatsapp: 'https://wa.me/201111111111'
        };

        // ğŸ“Š Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙˆØ§Ù„Ø±ØªØ¨
        const RANK_SYSTEM = {
            attendance: [
                { level: 1, name: 'Ù…Ø¨ØªØ¯Ø¦', min: 0, color: '#6b7280' },
                { level: 2, name: 'Ù…Ù†ØªØ¸Ù…', min: 10, color: '#3b82f6' },
                { level: 3, name: 'Ù…Ù„ØªØ²Ù…', min: 30, color: '#8b5cf6' },
                { level: 4, name: 'Ù…ØªÙÙˆÙ‚', min: 60, color: '#10b981' },
                { level: 5, name: 'Ø¨Ø·Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±', min: 100, color: '#fbbf24' }
            ],
            performance: [
                { level: 1, name: 'ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†', min: 0, color: '#6b7280' },
                { level: 2, name: 'Ù…Ù‚Ø¨ÙˆÙ„', min: 60, color: '#3b82f6' },
                { level: 3, name: 'Ø¬ÙŠØ¯', min: 75, color: '#10b981' },
                { level: 4, name: 'Ù…ØªÙ…ÙŠØ²', min: 85, color: '#8b5cf6' },
                { level: 5, name: 'Ø¹Ø¨Ù‚Ø±ÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª', min: 95, color: '#fbbf24' }
            ]
        };

        // ğŸ›¡ï¸ SafeIcon Component
        const SafeIcon = ({ name, size = 20, className = '' }) => {
            const icons = {
                'home': 'ğŸ ', 'video': 'ğŸ¬', 'play-circle': 'â–¶ï¸', 'credit-card': 'ğŸ’³',
                'help-circle': 'â“', 'gift': 'ğŸ', 'trending-up': 'ğŸ“ˆ', 'calendar-check': 'ğŸ“…',
                'bell': 'ğŸ””', 'message-circle': 'ğŸ’¬', 'calculator': 'ğŸ§®', 'user': 'ğŸ‘¤',
                'key': 'ğŸ”‘', 'clock': 'â°', 'send': 'ğŸ“¤', 'log-in': 'â†ªï¸', 'menu': 'â˜°',
                'x': 'âœ–ï¸', 'check': 'âœ“', 'check-circle': 'âœ…', 'alert-circle': 'âš ï¸',
                'trash-2': 'ğŸ—‘ï¸', 'arrow-right': 'â†’', 'arrow-left': 'â†', 'lock': 'ğŸ”’',
                'unlock': 'ğŸ”“', 'star': 'â­', 'lightbulb': 'ğŸ’¡', 'mail': 'âœ‰ï¸',
                'phone': 'ğŸ“', 'book-open': 'ğŸ“–', 'file-text': 'ğŸ“„', 'image': 'ğŸ–¼ï¸',
                'headphones': 'ğŸ§', 'settings': 'âš™ï¸', 'facebook': 'f', 'youtube': 'â–¶',
                'instagram': 'ğŸ“·', 'users': 'ğŸ‘¥', 'shield': 'ğŸ›¡ï¸', 'eye': 'ğŸ‘ï¸',
                'eye-off': 'ğŸ‘ï¸â€ğŸ—¨ï¸', 'link': 'ğŸ”—', 'parent': 'ğŸ‘¨â€ğŸ‘¦', 'student': 'ğŸ‘¨â€ğŸ“',
                'admin': 'ğŸ‘¨â€ğŸ’¼', 'logout': 'ğŸšª', 'search': 'ğŸ”', 'filter': 'âš™ï¸',
                'download': 'â¬‡ï¸', 'upload': 'â¬†ï¸', 'edit': 'âœï¸', 'copy': 'ğŸ“‹'
            };
            
            const emoji = icons[name] || 'ğŸ”¹';
            
            return (
                <span 
                    style={{ 
                        fontSize: `${size * 0.7}px`,
                        display: 'inline-block',
                        width: `${size}px`,
                        height: `${size}px`,
                        lineHeight: 1
                    }}
                    className={className}
                >
                    {emoji}
                </span>
            );
        };

        // ğŸ›¡ï¸ Error Boundary Component
        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false, error: null };
            }
            
            static getDerivedStateFromError(error) {
                return { hasError: true, error };
            }
            
            componentDidCatch(error, errorInfo) {
                console.error('App Error:', error, errorInfo);
            }
            
            render() {
                if (this.state.hasError) {
                    return (
                        <div className="min-h-screen bg-brand-dark flex items-center justify-center p-4">
                            <div className="glass-panel p-8 text-center">
                                <div className="text-6xl mb-4">âš ï¸</div>
                                <h2 className="text-2xl font-bold text-red-400 mb-2">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h2>
                                <p className="text-slate-400 mb-4">Ø³ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹...</p>
                                <button 
                                    onClick={() => window.location.reload()}
                                    className="btn-main px-6 py-3 rounded-xl"
                                >
                                    Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„
                                </button>
                            </div>
                        </div>
                    );
                }
                return this.props.children;
            }
        }

        const App = () => {
            // --- State Management ---
            const [user, setUser] = useState(null); 
            const [view, setView] = useState('landing'); 
            const [registrationType, setRegistrationType] = useState(null); // 'student', 'parent', 'admin'
            const [dataState, setDataState] = useState({ 
                students: [], parents: [], requests: [], lectures: [], whiteboards: [], 
                qa: [], exams: [], announcements: [], payments: [], subscriptions: {},
                freeContent: [], attendance: {}, performance: {}, weeklyAssessments: {},
                parentConnections: {} // Ø±Ø¨Ø· Ø§Ù„Ø¢Ø¨Ø§Ø¡ Ø¨Ø§Ù„Ø·Ù„Ø§Ø¨
            });
            
            // Registration Data - Ù…Ù†ÙØµÙ„ Ù„ÙƒÙ„ Ù†ÙˆØ¹
            const [studentRegData, setStudentRegData] = useState({ 
                firstName: '',
                secondName: '',
                thirdName: '',
                phone: '', 
                parentPhone: '', 
                school: '',
                governorate: '', 
                city: '',
                center: '',
                grade: '1sec',
                address: '',
                scheduleDays: 'Ø§Ù„Ø§Ø«Ù†ÙŠÙ† ÙˆØ§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡'
            });
            
            const [parentRegData, setParentRegData] = useState({
                name: '',
                phone: '',
                email: '',
                relationship: 'Ø£Ø¨', // Ø£Ø¨ØŒ Ø£Ù…ØŒ ÙˆÙ„ÙŠ Ø£Ù…Ø±
                studentsCount: 1,
                notes: ''
            });
            
            const [adminLoginCode, setAdminLoginCode] = useState('');
            const [studentLoginCode, setStudentLoginCode] = useState('');
            const [parentLoginCode, setParentLoginCode] = useState('');
            
            // UI States
            const [activeTab, setActiveTab] = useState('home');
            const [selectedLecture, setSelectedLecture] = useState(null);
            const [currentLectureStep, setCurrentLectureStep] = useState('video');
            const [sidebarOpen, setSidebarOpen] = useState(false);
            const [notification, setNotification] = useState(null);
            const [showStudentModal, setShowStudentModal] = useState(false);
            const [selectedStudent, setSelectedStudent] = useState(null);
            const [searchQuery, setSearchQuery] = useState('');
            const [showFreeContent, setShowFreeContent] = useState(false);
            const [activeGrade, setActiveGrade] = useState('all');
            const [showAssessmentModal, setShowAssessmentModal] = useState(false);
            const [isGuestMode, setIsGuestMode] = useState(false);
            
            // Quiz State
            const [quizAnswers, setQuizAnswers] = useState({});
            const [quizSubmitted, setQuizSubmitted] = useState(false);

            // Attendance State
            const [attendanceChecked, setAttendanceChecked] = useState(false);

            // Parent State
            const [linkedStudents, setLinkedStudents] = useState([]);
            const [parentView, setParentView] = useState('overview'); // overview, student-details, progress

            const showNotification = (message, type = 'success') => {
                setNotification({ message, type });
                setTimeout(() => setNotification(null), 4000);
            };

            // --- ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯ Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ---
            const generateRandomCode = (prefix) => {
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                let code = prefix + '-';
                for (let i = 0; i < 8; i++) {
                    code += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return code;
            };

            const generateStudentCode = () => generateRandomCode('STU');
            const generateParentCode = () => generateRandomCode('PAR');
            const generateAdminCode = () => generateRandomCode('ADM');

            // --- Calculate Rank ---
            const calculateRank = (type, value) => {
                const ranks = RANK_SYSTEM[type];
                for (let i = ranks.length - 1; i >= 0; i--) {
                    if (value >= ranks[i].min) {
                        return ranks[i];
                    }
                }
                return ranks[0];
            };

            // --- WhatsApp Message Generator ---
            const generateWelcomeMessage = (name, code, phone, type = 'student') => {
                if (type === 'student') {
                    return `ğŸ‰ *Ù…Ø¨Ø±ÙˆÙƒ Ù‚Ø¨ÙˆÙ„Ùƒ ÙÙŠ Ù…Ù†ØµØ© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ Ù„Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª!*\n\nğŸ‘¤ *Ø§Ù„Ø·Ø§Ù„Ø¨:* ${name}\nğŸ”‘ *ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„:* ${code}\nğŸ“± *Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:* ${phone}\n\nğŸ“š *Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„:*\n1. Ø§Ø¯Ø®Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹: https://el-alamy.com\n2. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨"\n3. Ø§Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯: ${code}\n\nğŸ’° *Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ:*\n1. Ø­ÙˆÙ„ 300 Ø¬Ù†ÙŠÙ‡ Ø¹Ù„Ù‰: ${CONTACT_INFO.vodafoneNumber}\n2. Ø§ÙƒØªØ¨ ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ø©: ${code}\n3. Ø£Ø±Ø³Ù„ Ø¥Ø«Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹ Ø¹Ù„Ù‰: ${CONTACT_INFO.supportWhatsapp}\n\nâœ… *Ø¨Ø¹Ø¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ ØªØ­ØµÙ„ Ø¹Ù„Ù‰:*\n- Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª ÙƒØ§Ù…Ù„Ø©\n- Ø§Ù…ØªØ­Ø§Ù†Ø§Øª ÙˆØªØ¯Ø±ÙŠØ¨Ø§Øª\n- Ù…ØªØ§Ø¨Ø¹Ø© Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©\n- Ø´Ù‡Ø§Ø¯Ø© Ù…Ø¹ØªÙ…Ø¯Ø©\n\nğŸš€ *Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ ØªÙÙˆÙ‚Ø§Ù‹ Ø¨Ø§Ù‡Ø±Ø§Ù‹!*`;
                } else if (type === 'parent') {
                    return `ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ *Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± ÙÙŠ Ù…Ù†ØµØ© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ Ù„Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª!*\n\nğŸ‘¤ *ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±:* ${name}\nğŸ”‘ *ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„:* ${code}\nğŸ“± *Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„:* ${phone}\n\nğŸ“š *Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„:*\n1. Ø§Ø¯Ø®Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹: https://el-alamy.com\n2. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¯Ø®ÙˆÙ„ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±"\n3. Ø§Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯: ${code}\n\nğŸ‘ï¸ *Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:*\n- Ù…ØªØ§Ø¨Ø¹Ø© Ø£Ø¯Ø§Ø¡ Ø£Ø¨Ù†Ø§Ø¦Ùƒ\n- ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨\n- Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª\n- Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©\n\nâœ… *Ø¨Ø¹Ø¯ Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ Ø£Ø¨Ù†Ø§Ø¦Ùƒ ØªØ­ØµÙ„ Ø¹Ù„Ù‰:*\n- ØªØ­Ø¯ÙŠØ«Ø§Øª Ù„Ø­Ø¸ÙŠØ©\n- ØªÙ‚Ø§Ø±ÙŠØ± Ø£Ø¯Ø§Ø¡ Ù…ÙØµÙ„Ø©\n- ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ù‡Ù…Ø©\n\nØ´ÙƒØ±Ø§Ù‹ Ù„Ø«Ù‚ØªÙƒÙ… Ø¨Ù†Ø§!`;
                }
                return '';
            };

            // --- Authentication ---
            useEffect(() => {
                window.authMethods.onAuthStateChanged(window.auth, async (u) => {
                    if (u) {
                        const s = await window.rtdb.get(window.rtdb.child(window.rtdb.ref(window.db), `users/${u.uid}`));
                        if (s.exists()) { 
                            const userData = s.val();
                            setUser({ ...userData, uid: u.uid, photo: u.photoURL }); 
                            
                            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø±ØªØ¨Ø·ÙŠÙ† Ø¥Ø°Ø§ ÙƒØ§Ù† ÙˆÙ„ÙŠ Ø£Ù…Ø±
                            if (userData.role === 'parent') {
                                loadLinkedStudents(userData.uid);
                            }
                            
                            setView(['admin', 'boss'].includes(userData.role) ? 'admin' : userData.role === 'parent' ? 'parent' : 'student'); 
                            
                            // Check today's attendance
                            if (userData.role === 'student') {
                                const today = new Date().toISOString().split('T')[0];
                                const attRef = window.rtdb.ref(window.db, `attendance/${u.uid}/${today}`);
                                window.rtdb.get(attRef).then(snap => {
                                    setAttendanceChecked(!!snap.exists());
                                });
                            }
                        } else { 
                            setUser({ uid: u.uid, name: u.displayName, email: u.email, photo: u.photoURL, isNew: true }); 
                            setView('choose-role'); 
                        }
                    } else { 
                        setUser(null); 
                        setView('landing');
                    }
                });
            }, []);

            // --- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø±ØªØ¨Ø·ÙŠÙ† Ø¨ÙˆÙ„Ø§ÙŠØ© Ø§Ù„Ø£Ù…Ø± ---
            const loadLinkedStudents = async (parentId) => {
                try {
                    const connectionsRef = window.rtdb.ref(window.db, `parentConnections/${parentId}`);
                    const snapshot = await window.rtdb.get(connectionsRef);
                    if (snapshot.exists()) {
                        const connections = snapshot.val();
                        const studentIds = Object.keys(connections);
                        
                        // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ Ø·Ø§Ù„Ø¨
                        const studentsPromises = studentIds.map(async (studentId) => {
                            const studentRef = window.rtdb.ref(window.db, `users/${studentId}`);
                            const studentSnap = await window.rtdb.get(studentRef);
                            if (studentSnap.exists()) {
                                return { id: studentId, ...studentSnap.val() };
                            }
                            return null;
                        });
                        
                        const students = (await Promise.all(studentsPromises)).filter(s => s !== null);
                        setLinkedStudents(students);
                        
                        // ØªØ­Ø¯ÙŠØ« state
                        setDataState(prev => ({
                            ...prev,
                            parentConnections: {
                                ...prev.parentConnections,
                                [parentId]: connections
                            }
                        }));
                    }
                } catch (error) {
                    console.error('Error loading linked students:', error);
                }
            };

            // --- Ø±Ø¨Ø· Ø·Ø§Ù„Ø¨ Ø¨ÙˆÙ„ÙŠ Ø£Ù…Ø± ---
            const linkStudentToParent = async (parentId, studentId, relationship = 'Ø§Ø¨Ù†/Ø§Ø¨Ù†Ø©') => {
                try {
                    const connectionRef = window.rtdb.ref(window.db, `parentConnections/${parentId}/${studentId}`);
                    await window.rtdb.set(connectionRef, {
                        linkedAt: new Date().toISOString(),
                        relationship: relationship,
                        canViewDetails: true,
                        canViewProgress: true,
                        canViewAttendance: true,
                        canViewGrades: true
                    });
                    
                    showNotification('ØªÙ… Ø±Ø¨Ø· Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± Ø¨Ù†Ø¬Ø§Ø­');
                    loadLinkedStudents(parentId); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                } catch (error) {
                    console.error('Error linking student:', error);
                    showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø±Ø¨Ø·', 'error');
                }
            };

            // --- Data Sync ---
            useEffect(() => {
                if (user || isGuestMode) {
                    // Sync lectures for all users
                    window.rtdb.onValue(window.rtdb.ref(window.db, 'lectures'), s => 
                        setDataState(p => ({ 
                            ...p, 
                            lectures: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })).sort((a, b) => (b.ts || 0) - (a.ts || 0)) : [] 
                        }))
                    );
                    
                    window.rtdb.onValue(window.rtdb.ref(window.db, 'freeContent'), s => 
                        setDataState(p => ({ 
                            ...p, 
                            freeContent: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })).sort((a, b) => (b.ts || 0) - (a.ts || 0)) : [] 
                        }))
                    );
                    
                    // Sync Q&A for all users
                    window.rtdb.onValue(window.rtdb.ref(window.db, 'qa'), s => 
                        setDataState(p => ({ 
                            ...p, 
                            qa: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })).sort((a, b) => (b.ts || 0) - (a.ts || 0)) : [] 
                        }))
                    );
                    
                    window.rtdb.onValue(window.rtdb.ref(window.db, 'announcements'), s => 
                        setDataState(p => ({ 
                            ...p, 
                            announcements: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })).sort((a, b) => (b.ts || 0) - (a.ts || 0)) : [] 
                        }))
                    );
                    
                    if (user) {
                        if (user.role === 'student') {
                            // Sync student-specific data
                            window.rtdb.onValue(window.rtdb.ref(window.db, `attendance/${user.uid}`), s => 
                                setDataState(p => ({ 
                                    ...p, 
                                    attendance: { ...p.attendance, [user.uid]: s.val() || {} } 
                                }))
                            );
                        }
                        
                        if (user.role === 'parent') {
                            // Sync parent connections
                            window.rtdb.onValue(window.rtdb.ref(window.db, `parentConnections/${user.uid}`), s => 
                                setDataState(p => ({
                                    ...p,
                                    parentConnections: { ...p.parentConnections, [user.uid]: s.val() || {} }
                                }))
                            );
                        }
                    }
                    
                    if (['admin', 'boss'].includes(user?.role)) {
                        // Sync admin-only data
                        window.rtdb.onValue(window.rtdb.ref(window.db, 'requests'), s => 
                            setDataState(p => ({ ...p, requests: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })) : [] }))
                        );
                        window.rtdb.onValue(window.rtdb.ref(window.db, 'users'), s => {
                            const allUsers = s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })) : [];
                            setDataState(p => ({ 
                                ...p, 
                                students: allUsers.filter(u => u.role === 'student'),
                                parents: allUsers.filter(u => u.role === 'parent')
                            }));
                        });
                        window.rtdb.onValue(window.rtdb.ref(window.db, 'payments'), s => 
                            setDataState(p => ({ ...p, payments: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })) : [] }))
                        );
                        window.rtdb.onValue(window.rtdb.ref(window.db, 'subscriptions'), s => 
                            setDataState(p => ({ ...p, subscriptions: s.val() || {} }))
                        );
                        window.rtdb.onValue(window.rtdb.ref(window.db, 'attendance'), s => 
                            setDataState(p => ({ ...p, attendance: s.val() || {} }))
                        );
                        window.rtdb.onValue(window.rtdb.ref(window.db, 'exams'), s => 
                            setDataState(p => ({ ...p, exams: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })) : [] }))
                        );
                        window.rtdb.onValue(window.rtdb.ref(window.db, 'whiteboards'), s => 
                            setDataState(p => ({ ...p, whiteboards: s.val() ? Object.entries(s.val()).map(([k, v]) => ({ id: k, ...v })) : [] }))
                        );
                    }
                }
            }, [user, isGuestMode]);

            // --- Helper Functions ---
            const renderContent = (link, type = 'video') => {
                if (!link) return null;
                if (link.trim().startsWith('<iframe') || link.trim().startsWith('<div')) 
                    return <div className="embed-wrapper" dangerouslySetInnerHTML={{__html: link}} />;
                if (link.includes('youtu')) {
                    const id = link.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?.[2];
                    return id ? <div className="embed-wrapper"><iframe src={`https://www.youtube.com/embed/${id}`} allowFullScreen></iframe></div> : null;
                }
                if (type === 'image' || link.match(/\.(jpeg|jpg|gif|png)$/) || link.includes('ibb.co')) {
                    return <img src={link} className="w-full rounded-xl shadow-lg border border-white/10" onError={(e)=>{e.target.src='https://placehold.co/600x400?text=Ø®Ø·Ø£';}} />;
                }
                if (link.includes('drive.google.com')) {
                    return <div className="embed-wrapper"><iframe src={link.replace('/view', '/preview').replace('/edit', '/preview')} allowFullScreen></iframe></div>;
                }
                return <a href={link} target="_blank" className="block w-full bg-white/10 text-white text-center py-3 rounded-xl font-bold border border-white/10 hover:bg-white/20">ğŸ”— ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·</a>;
            };

            const calculateSubscriptionDays = (subscriptionEnd) => {
                if (!subscriptionEnd) return 0;
                const now = new Date();
                const end = new Date(subscriptionEnd);
                const diffTime = end - now;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                return diffDays > 0 ? diffDays : 0;
            };

            // --- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø·Ø§Ù„Ø¨ ---
            const handleStudentLogin = async () => {
                if (studentLoginCode.length < 3) {
                    return showNotification('Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ', 'error');
                }
                
                const student = dataState.students.find(s => s.code === studentLoginCode);
                if (student) {
                    if (student.status === 'pending') {
                        setView('pending-approval');
                    } else {
                        // Set user and view
                        setUser({ ...student, uid: student.id });
                        setView('student');
                        showNotification(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${student.firstName} ${student.secondName}!`);
                    }
                } else {
                    showNotification('Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
                }
            };

            // --- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± ---
            const handleParentLogin = async () => {
                if (parentLoginCode.length < 3) {
                    return showNotification('Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ', 'error');
                }
                
                const parent = dataState.parents.find(p => p.code === parentLoginCode);
                if (parent) {
                    setUser({ ...parent, uid: parent.id });
                    setView('parent');
                    showNotification(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${parent.name}!`);
                } else {
                    showNotification('Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
                }
            };

            // --- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© ---
            const handleAdminLogin = async () => {
                if (!user) return showNotification('Ø³Ø¬Ù„ Ø¨Ø¬ÙˆØ¬Ù„ Ø§Ù„Ø£ÙˆÙ„', 'error');
                
                // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
                const savedCodes = JSON.parse(localStorage.getItem('ADMIN_CODES') || '{}');
                let validCode = null;
                
                // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯
                Object.values(savedCodes).forEach(admin => {
                    if (admin.code === adminLoginCode) {
                        validCode = admin;
                    }
                });
                
                if (validCode) {
                    await window.rtdb.set(window.rtdb.ref(window.db, 'users/' + user.uid), { 
                        ...user, 
                        role: validCode.role, 
                        adminLevel: validCode.name,
                        isNew: false 
                    });
                    
                    // Ø­ÙØ¸ ÙÙŠ localStorage Ù„Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹
                    localStorage.setItem('admin_logged_in', 'true');
                    localStorage.setItem('admin_role', validCode.role);
                    
                    showNotification(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${validCode.name}!`);
                    setTimeout(() => window.location.reload(), 1000);
                } else {
                    showNotification('Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
                }
            };

            // --- Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ ---
            const submitRegistration = async (type) => {
                let data, collection, userData;
                
                if (type === 'student') {
                    const required = ['firstName', 'secondName', 'phone', 'parentPhone', 'school', 'grade'];
                    const missing = required.filter(field => !studentRegData[field]);
                    
                    if(missing.length > 0) {
                        return showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§ÙƒØªØ¨ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (*)', 'error');
                    }
                    
                    const fullName = `${studentRegData.firstName} ${studentRegData.secondName} ${studentRegData.thirdName || ''}`.trim();
                    const studentCode = generateStudentCode();
                    
                    data = { 
                        ...studentRegData, 
                        name: fullName,
                        uid: user.uid, 
                        email: user.email, 
                        photo: user.photo, 
                        code: studentCode,
                        role: 'student',
                        status: 'pending',
                        date: new Date().toLocaleDateString(),
                        ts: Date.now()
                    };
                    
                    collection = 'requests';
                    
                } else if (type === 'parent') {
                    const required = ['name', 'phone'];
                    const missing = required.filter(field => !parentRegData[field]);
                    
                    if(missing.length > 0) {
                        return showNotification('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§ÙƒØªØ¨ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (*)', 'error');
                    }
                    
                    const parentCode = generateParentCode();
                    
                    data = {
                        ...parentRegData,
                        uid: user.uid,
                        email: user.email,
                        photo: user.photo,
                        code: parentCode,
                        role: 'parent',
                        status: 'pending',
                        date: new Date().toLocaleDateString(),
                        ts: Date.now()
                    };
                    
                    collection = 'parentRequests';
                    
                } else {
                    return;
                }
                
                // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
                await window.rtdb.set(window.rtdb.push(window.rtdb.ref(window.db, collection)), data);
                
                showNotification(`ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ ${type === 'student' ? 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨' : 'ØªØ³Ø¬ÙŠÙ„ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±'}!`);
                setTimeout(() => {
                    setView('pending-approval');
                }, 2000);
            };

            const uploadItem = async (collection, data) => {
                await window.rtdb.push(window.rtdb.ref(window.db, collection), { 
                    ...data, 
                    date: new Date().toLocaleDateString('ar-EG'), 
                    ts: Date.now() 
                });
                showNotification('ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­ âœ…');
            };

            const updateStudent = async (id, data) => {
                try {
                    await window.rtdb.update(window.rtdb.ref(window.db, `users/${id}`), data);
                    showNotification('ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« ğŸ‘Œ');
                    
                    setDataState(prev => ({
                        ...prev,
                        students: prev.students.map(s => 
                            s.id === id ? { ...s, ...data } : s
                        )
                    }));
                } catch (error) {
                    console.error('Error updating student:', error);
                    showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«', 'error');
                }
            };

            const addSubscription = async (studentId, months) => {
                const now = new Date();
                const end = new Date(now.setMonth(now.getMonth() + months));
                await window.rtdb.update(window.rtdb.ref(window.db, `subscriptions/${studentId}`), {
                    startDate: new Date().toISOString(),
                    endDate: end.toISOString(),
                    months: months
                });
                await updateStudent(studentId, { isPaid: true });
                showNotification(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ø´ØªØ±Ø§Ùƒ ${months} Ø´Ù‡Ø±`);
            };

            const markAttendance = async () => {
                if (!user || user.role !== 'student') return;
                
                const today = new Date();
                const dayName = today.toLocaleDateString('ar-EG', { weekday: 'long' });
                if (!user.scheduleDays || !user.scheduleDays.includes(dayName)) {
                    return showNotification('Ø§Ù„ÙŠÙˆÙ… Ù„ÙŠØ³ Ù…Ù† Ø£ÙŠØ§Ù… Ø­ØµØµÙƒ Ø§Ù„Ù…Ù‚Ø±Ø±Ø©', 'warning');
                }
                
                const todayStr = today.toISOString().split('T')[0];
                await window.rtdb.set(window.rtdb.ref(window.db, `attendance/${user.uid}/${todayStr}`), {
                    timestamp: Date.now(),
                    date: todayStr,
                    day: dayName
                });
                
                setAttendanceChecked(true);
                showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±Ùƒ Ø§Ù„ÙŠÙˆÙ…! ğŸ‰', 'success');
            };

            const generatePaymentCode = () => {
                return `ALAMY${Date.now().toString().slice(-8)}`;
            };

            const handleGuestMode = () => {
                setIsGuestMode(true);
                setView('guest');
                showNotification('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙƒØ²Ø§Ø¦Ø±! ÙŠÙ…ÙƒÙ†Ùƒ ØªØµÙØ­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ', 'info');
            };

            const sendWhatsAppToStudent = (student) => {
                const message = generateWelcomeMessage(
                    `${student.firstName} ${student.secondName}`,
                    student.code,
                    student.phone,
                    'student'
                );
                const encodedMessage = encodeURIComponent(message);
                const whatsappUrl = `https://wa.me/${student.parentPhone || student.phone}?text=${encodedMessage}`;
                window.open(whatsappUrl, '_blank');
            };

            // --- Ø¹Ø±Ø¶ ÙƒÙˆØ¯ Ø§Ù„Ø£Ø¯Ù…Ù† Ù„Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø­Ø§Ù„ÙŠ ---
            const showAdminCodes = () => {
                const savedCodes = JSON.parse(localStorage.getItem('ADMIN_CODES') || '{}');
                let message = 'ğŸ” **Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:**\n\n';
                
                Object.values(savedCodes).forEach((admin, idx) => {
                    message += `${idx + 1}. ${admin.name}\n`;
                    message += `   Ø§Ù„ÙƒÙˆØ¯: **${admin.code}**\n`;
                    message += `   Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©: ${admin.role}\n\n`;
                });
                
                alert(message);
            };

            // --- VIEWS ---

            // ğŸ¨ Landing Page - Ù…Ø­Ø¯Ø«
            if (view === 'landing') return (
                <div className="min-h-screen bg-brand-dark text-white relative overflow-hidden math-grid flex flex-col">
                    <div className="absolute top-0 left-0 w-full h-full hero-glow z-0"></div>
                    
                    <header className="relative z-50 p-6 flex justify-between items-center container mx-auto">
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 bg-brand-accent rounded-lg flex items-center justify-center text-brand-dark font-black text-xl">âˆ‘</div>
                            <h1 className="text-2xl font-black tracking-tighter">Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</h1>
                        </div>
                        <div className="flex gap-3 flex-wrap">
                            <button onClick={()=>window.authMethods.signInWithPopup(window.auth, window.googleProvider)} 
                                    className="bg-white/10 hover:bg-white/20 border border-white/20 px-6 py-2 rounded-full font-bold transition text-sm">
                                ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
                            </button>
                            <button onClick={()=>{
                                setRegistrationType('student');
                                setView('registration');
                            }} 
                                    className="bg-blue-600/20 hover:bg-blue-600/40 border border-blue-500/30 px-6 py-2 rounded-full font-bold transition text-sm">
                                ØªØ³Ø¬ÙŠÙ„ Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
                            </button>
                            <button onClick={()=>{
                                setRegistrationType('parent');
                                setView('registration');
                            }}
                                    className="bg-green-600/20 hover:bg-green-600/40 border border-green-500/30 px-6 py-2 rounded-full font-bold transition text-sm">
                                ØªØ³Ø¬ÙŠÙ„ ÙˆÙ„ÙŠ Ø£Ù…Ø±
                            </button>
                            <button onClick={handleGuestMode}
                                    className="bg-purple-600/20 hover:bg-purple-600/40 border border-purple-500/30 px-6 py-2 rounded-full font-bold transition text-sm">
                                ØªØµÙØ­ ÙƒØ²Ø§Ø¦Ø±
                            </button>
                        </div>
                    </header>

                    <div className="flex-1 container mx-auto px-4 flex flex-col-reverse md:flex-row items-center justify-center gap-10 relative z-20 py-10">
                        <div className="text-center md:text-right space-y-6 md:w-1/2 animate-slide-up">
                            <div className="inline-block bg-blue-500/20 text-blue-300 px-4 py-1 rounded-full text-sm font-bold border border-blue-500/30">
                                ğŸš€ Ø£Ù‚ÙˆÙ‰ Ù…Ù†ØµØ© Ø±ÙŠØ§Ø¶ÙŠØ§Øª ÙÙŠ Ù…ØµØ±
                            </div>
                            
                            <h1 className="text-5xl md:text-7xl font-black leading-tight">
                                Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª<br/>
                                <span className="text-brand-accent">Ù„Ø¹Ø¨ØªÙƒ Ù…Ø¹Ø§Ù†Ø§!</span>
                            </h1>
                            
                            <p className="text-slate-300 text-lg md:text-xl font-medium max-w-lg mx-auto md:mx-0">
                                Ù…Ø¹ Ø£/ Ø£Ø­Ù…Ø¯ Ø³Ø¹Ø¯ ÙŠÙˆÙ†Ø³.. Ø§Ù„ØªÙØ§Ø¶Ù„ ÙˆØ§Ù„ØªÙƒØ§Ù…Ù„ ÙˆØ§Ù„Ø¬Ø¨Ø± Ø¨Ù‚ÙˆØ§ Ø£Ø³Ù‡Ù„ Ù…Ù…Ø§ ØªØªØ®ÙŠÙ„. 
                                Ø´Ø±Ø­ØŒ Ø­Ù„ØŒ Ù…ØªØ§Ø¨Ø¹Ø©ØŒ ÙˆØ§Ù…ØªØ­Ø§Ù†Ø§Øª Ø¯ÙˆØ±ÙŠØ© ØªØ¶Ù…Ù†Ù„Ùƒ Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©.
                            </p>
                            
                            <div className="flex flex-col sm:flex-row gap-4 justify-center md:justify-start pt-4">
                                <button onClick={()=>window.authMethods.signInWithPopup(window.auth, window.googleProvider)} 
                                        className="btn-main px-8 py-4 rounded-xl text-xl flex items-center justify-center gap-2">
                                    Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù† <SafeIcon name="calculator"/>
                                </button>
                                
                                {/* Ø²Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© (Ù…Ø®ÙÙŠ Ù„Ù„Ø¹Ø§Ù…Ø©) */}
                                <button onClick={()=>{
                                    const code = prompt('Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:');
                                    if (code) {
                                        setAdminLoginCode(code);
                                        window.authMethods.signInWithPopup(window.auth, window.googleProvider)
                                            .then(() => {
                                                setTimeout(() => {
                                                    handleAdminLogin();
                                                }, 1000);
                                            });
                                    }
                                }} 
                                        className="bg-red-600/20 hover:bg-red-600/40 border border-red-500/30 px-6 py-4 rounded-xl text-xl flex items-center justify-center gap-2">
                                    <SafeIcon name="shield"/> Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                                </button>
                            </div>
                            
                            <div className="pt-6">
                                <p className="text-slate-400 mb-3">Ø£Ùˆ Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ù…Ø¨Ø§Ø´Ø±:</p>
                                <div className="flex gap-3 justify-center md:justify-start">
                                    <button onClick={()=>setView('student-login')} 
                                            className="px-4 py-2 bg-blue-500/20 hover:bg-blue-500/40 border border-blue-500/30 rounded-lg">
                                        Ø¯Ø®ÙˆÙ„ Ø·Ø§Ù„Ø¨
                                    </button>
                                    <button onClick={()=>setView('parent-login')} 
                                            className="px-4 py-2 bg-green-500/20 hover:bg-green-500/40 border border-green-500/30 rounded-lg">
                                        Ø¯Ø®ÙˆÙ„ ÙˆÙ„ÙŠ Ø£Ù…Ø±
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="md:w-1/2 relative flex justify-center items-end">
                            <div className="absolute inset-0 bg-brand-primary/30 blur-[100px] rounded-full"></div>
                            <img src="./alalamy.png" 
                                 className="relative z-10 w-full max-w-md object-contain drop-shadow-2xl animate-float hover:scale-105 transition-transform duration-500" 
                                 alt="Ø£/ Ø£Ø­Ù…Ø¯ Ø³Ø¹Ø¯ ÙŠÙˆÙ†Ø³" 
                                 onError={(e)=>{e.target.style.display='none'}}/>
                        </div>
                    </div>

                    {/* Registration Options */}
                    <section className="py-10 bg-gradient-to-b from-black/20 to-brand-dark">
                        <div className="container mx-auto px-4">
                            <h2 className="text-3xl font-black text-center mb-8">Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</h2>
                            <div className="grid md:grid-cols-3 gap-6">
                                {/* Student Registration */}
                                <div className="glass-panel p-6 text-center hover:border-blue-500/50 transition cursor-pointer" onClick={()=>{
                                    setRegistrationType('student');
                                    setView('registration');
                                }}>
                                    <div className="w-16 h-16 bg-blue-500/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <SafeIcon name="student" size={32} className="text-blue-400"/>
                                    </div>
                                    <h3 className="text-xl font-bold mb-2">ØªØ³Ø¬ÙŠÙ„ Ø·Ø§Ù„Ø¨</h3>
                                    <p className="text-slate-400 text-sm">Ù„Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ø°ÙŠÙ† ÙŠØ±ØºØ¨ÙˆÙ† ÙÙŠ Ø§Ù„Ø§Ù„ØªØ­Ø§Ù‚ Ø¨Ø§Ù„Ù…Ù†ØµØ© ÙˆØ§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø§Ù„ÙƒØ§Ù…Ù„</p>
                                    <div className="mt-4 text-xs text-blue-300">
                                        <p>âœ“ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©</p>
                                        <p>âœ“ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</p>
                                        <p>âœ“ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</p>
                                    </div>
                                </div>

                                {/* Parent Registration */}
                                <div className="glass-panel p-6 text-center hover:border-green-500/50 transition cursor-pointer" onClick={()=>{
                                    setRegistrationType('parent');
                                    setView('registration');
                                }}>
                                    <div className="w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <SafeIcon name="parent" size={32} className="text-green-400"/>
                                    </div>
                                    <h3 className="text-xl font-bold mb-2">ØªØ³Ø¬ÙŠÙ„ ÙˆÙ„ÙŠ Ø£Ù…Ø±</h3>
                                    <p className="text-slate-400 text-sm">Ù„Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ± Ø§Ù„Ø°ÙŠÙ† ÙŠØ±ØºØ¨ÙˆÙ† ÙÙŠ Ù…ØªØ§Ø¨Ø¹Ø© Ø£Ø¨Ù†Ø§Ø¦Ù‡Ù… ÙˆØ§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</p>
                                    <div className="mt-4 text-xs text-green-300">
                                        <p>âœ“ Ù…ØªØ§Ø¨Ø¹Ø© Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ø¨Ù†Ø§Ø¡</p>
                                        <p>âœ“ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨</p>
                                        <p>âœ“ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ†</p>
                                    </div>
                                </div>

                                {/* Guest Access */}
                                <div className="glass-panel p-6 text-center hover:border-purple-500/50 transition cursor-pointer" onClick={handleGuestMode}>
                                    <div className="w-16 h-16 bg-purple-500/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                        <SafeIcon name="user" size={32} className="text-purple-400"/>
                                    </div>
                                    <h3 className="text-xl font-bold mb-2">ØªØµÙØ­ ÙƒØ²Ø§Ø¦Ø±</h3>
                                    <p className="text-slate-400 text-sm">ØªØµÙØ­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ ÙˆØ§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØµØ© Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</p>
                                    <div className="mt-4 text-xs text-purple-300">
                                        <p>âœ“ Ù…Ø­ØªÙˆÙ‰ Ù…Ø¬Ø§Ù†ÙŠ Ù…Ø­Ø¯ÙˆØ¯</p>
                                        <p>âœ“ Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØµØ©</p>
                                        <p>âœ“ Ù„Ø§ ÙŠØªØ·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Rest of the landing page remains the same */}
                    {/* ... */}
                </div>
            );

            // ğŸ“ ØµÙØ­Ø© Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
            if (view === 'choose-role') return (
                <div className="min-h-screen bg-brand-dark flex items-center justify-center p-4">
                    <div className="glass-panel p-8 w-full max-w-2xl animate-slide-up">
                        <div className="text-center mb-8">
                            <img src={user.photo} className="w-20 h-20 rounded-full mx-auto mb-4 border-4 border-brand-accent"/>
                            <h2 className="text-3xl font-bold text-white mb-2">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ! ğŸ‘‹</h2>
                            <p className="text-slate-400">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø°ÙŠ ØªØ±ØºØ¨ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¦Ù‡</p>
                        </div>

                        <div className="grid md:grid-cols-3 gap-6">
                            {/* Student Account */}
                            <div className="bg-blue-500/10 border border-blue-500/30 p-6 rounded-xl text-center hover:border-blue-500/50 transition cursor-pointer" onClick={()=>{
                                setRegistrationType('student');
                                setView('registration');
                            }}>
                                <div className="w-20 h-20 bg-blue-500/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <SafeIcon name="student" size={40} className="text-blue-400"/>
                                </div>
                                <h3 className="text-xl font-bold mb-2">Ø­Ø³Ø§Ø¨ Ø·Ø§Ù„Ø¨</h3>
                                <p className="text-slate-400 text-sm mb-4">Ù„Ù„Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ ÙˆØ§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ù…Ù†ØµØ©</p>
                                <div className="text-xs text-blue-300 space-y-1">
                                    <p>â€¢ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©</p>
                                    <p>â€¢ Ø­Ù„ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª ÙˆØ§Ù„ØªØ¯Ø±ÙŠØ¨Ø§Øª</p>
                                    <p>â€¢ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ†</p>
                                    <p>â€¢ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø´Ù‡Ø§Ø¯Ø©</p>
                                </div>
                            </div>

                            {/* Parent Account */}
                            <div className="bg-green-500/10 border border-green-500/30 p-6 rounded-xl text-center hover:border-green-500/50 transition cursor-pointer" onClick={()=>{
                                setRegistrationType('parent');
                                setView('registration');
                            }}>
                                <div className="w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <SafeIcon name="parent" size={40} className="text-green-400"/>
                                </div>
                                <h3 className="text-xl font-bold mb-2">Ø­Ø³Ø§Ø¨ ÙˆÙ„ÙŠ Ø£Ù…Ø±</h3>
                                <p className="text-slate-400 text-sm mb-4">Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø£Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</p>
                                <div className="text-xs text-green-300 space-y-1">
                                    <p>â€¢ Ù…ØªØ§Ø¨Ø¹Ø© Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£Ø¨Ù†Ø§Ø¡</p>
                                    <p>â€¢ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨</p>
                                    <p>â€¢ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</p>
                                    <p>â€¢ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</p>
                                </div>
                            </div>

                            {/* Admin Account */}
                            <div className="bg-yellow-500/10 border border-yellow-500/30 p-6 rounded-xl text-center hover:border-yellow-500/50 transition cursor-pointer" onClick={()=>{
                                setView('admin-login');
                            }}>
                                <div className="w-20 h-20 bg-yellow-500/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <SafeIcon name="admin" size={40} className="text-yellow-400"/>
                                </div>
                                <h3 className="text-xl font-bold mb-2">Ø­Ø³Ø§Ø¨ Ø¥Ø¯Ø§Ø±ÙŠ</h3>
                                <p className="text-slate-400 text-sm mb-4">Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ†</p>
                                <div className="text-xs text-yellow-300 space-y-1">
                                    <p>â€¢ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ</p>
                                    <p>â€¢ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</p>
                                    <p>â€¢ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª</p>
                                    <p>â€¢ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ÙƒØ§Ù…Ù„Ø©</p>
                                </div>
                                <div className="mt-4 text-xs text-red-400">
                                    * ÙŠØªØ·Ù„Ø¨ ÙƒÙˆØ¯ Ø®Ø§Øµ
                                </div>
                            </div>
                        </div>

                        <div className="mt-8 text-center">
                            <button onClick={()=>window.authMethods.signOut(window.auth)} 
                                    className="text-slate-400 hover:text-white">
                                Ø§Ù„Ø±Ø¬ÙˆØ¹ ÙˆØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
                            </button>
                        </div>
                    </div>
                </div>
            );

            // ğŸ“ ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (Ù…ÙˆØ­Ø¯Ø© Ù„ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹)
            if (view === 'registration') return (
                <div className="min-h-screen bg-brand-dark flex items-center justify-center p-4">
                    <div className="glass-panel p-8 w-full max-w-2xl animate-slide-up">
                        <div className="text-center mb-8">
                            <div className="w-20 h-20 bg-brand-accent/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                <SafeIcon name={registrationType === 'student' ? 'student' : 'parent'} size={40} className="text-brand-accent"/>
                            </div>
                            <h2 className="text-3xl font-bold text-white mb-2">
                                {registrationType === 'student' ? 'ØªØ³Ø¬ÙŠÙ„ Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯' : 'ØªØ³Ø¬ÙŠÙ„ ÙˆÙ„ÙŠ Ø£Ù…Ø±'}
                            </h2>
                            <p className="text-slate-400">Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©</p>
                        </div>

                        {registrationType === 'student' ? (
                            <div className="space-y-4">
                                <div className="grid md:grid-cols-3 gap-4">
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„ *" 
                                        onChange={e=>setStudentRegData({...studentRegData, firstName: e.target.value})}
                                    />
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ *" 
                                        onChange={e=>setStudentRegData({...studentRegData, secondName: e.target.value})}
                                    />
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ø§Ù„Ø«" 
                                        onChange={e=>setStudentRegData({...studentRegData, thirdName: e.target.value})}
                                    />
                                </div>

                                <div className="grid md:grid-cols-2 gap-4">
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø±Ù‚Ù… ØªÙ„ÙŠÙÙˆÙ†Ùƒ ğŸ“± *" 
                                        onChange={e=>setStudentRegData({...studentRegData, phone: e.target.value})}
                                    />
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø±Ù‚Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ *" 
                                        onChange={e=>setStudentRegData({...studentRegData, parentPhone: e.target.value})}
                                    />
                                </div>

                                <input 
                                    className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                    placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ğŸ« *" 
                                    onChange={e=>setStudentRegData({...studentRegData, school: e.target.value})}
                                />

                                <div className="grid md:grid-cols-2 gap-4">
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© ğŸ—ºï¸ *" 
                                        onChange={e=>setStudentRegData({...studentRegData, governorate: e.target.value})}
                                    />
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© / Ø§Ù„Ù…Ø±ÙƒØ² ğŸ“ *" 
                                        onChange={e=>setStudentRegData({...studentRegData, city: e.target.value})}
                                    />
                                </div>

                                <input 
                                    className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                    placeholder="Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ ğŸ¯" 
                                    onChange={e=>setStudentRegData({...studentRegData, center: e.target.value})}
                                />

                                <textarea 
                                    className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                    placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙØµÙŠÙ„ÙŠ ğŸ " 
                                    rows="2"
                                    onChange={e=>setStudentRegData({...studentRegData, address: e.target.value})}
                                />

                                <div className="grid md:grid-cols-2 gap-4">
                                    <select 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        onChange={e=>setStudentRegData({...studentRegData, grade: e.target.value})}
                                    >
                                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ *</option>
                                        <option value="1sec">Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                                        <option value="2sec">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                                        <option value="3sec">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                                    </select>

                                    <select 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        onChange={e=>setStudentRegData({...studentRegData, scheduleDays: e.target.value})}
                                    >
                                        <option value="">Ø£ÙŠØ§Ù… Ø§Ù„Ø­ØµØµ Ø§Ù„Ù…ÙØ¶Ù„Ø© *</option>
                                        <option value="Ø§Ù„Ø§Ø«Ù†ÙŠÙ† ÙˆØ§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡">Ø§Ù„Ø§Ø«Ù†ÙŠÙ† ÙˆØ§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option>
                                        <option value="Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡ ÙˆØ§Ù„Ø®Ù…ÙŠØ³">Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡ ÙˆØ§Ù„Ø®Ù…ÙŠØ³</option>
                                        <option value="Ø§Ù„Ø³Ø¨Øª ÙˆØ§Ù„Ø£Ø­Ø¯">Ø§Ù„Ø³Ø¨Øª ÙˆØ§Ù„Ø£Ø­Ø¯</option>
                                        <option value="Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙŠØ§Ù…">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙŠØ§Ù…</option>
                                    </select>
                                </div>
                            </div>
                        ) : (
                            <div className="space-y-4">
                                <input 
                                    className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                    placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ *" 
                                    onChange={e=>setParentRegData({...parentRegData, name: e.target.value})}
                                />

                                <div className="grid md:grid-cols-2 gap-4">
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ğŸ“± *" 
                                        onChange={e=>setParentRegData({...parentRegData, phone: e.target.value})}
                                    />
                                    <input 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" 
                                        type="email"
                                        onChange={e=>setParentRegData({...parentRegData, email: e.target.value})}
                                    />
                                </div>

                                <select 
                                    className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                    onChange={e=>setParentRegData({...parentRegData, relationship: e.target.value})}
                                >
                                    <option value="Ø£Ø¨">Ø£Ø¨</option>
                                    <option value="Ø£Ù…">Ø£Ù…</option>
                                    <option value="ÙˆÙ„ÙŠ Ø£Ù…Ø±">ÙˆÙ„ÙŠ Ø£Ù…Ø±</option>
                                    <option value="Ø£Ø®">Ø£Ø®</option>
                                    <option value="Ø£Ø®Øª">Ø£Ø®Øª</option>
                                </select>

                                <div className="grid md:grid-cols-2 gap-4">
                                    <select 
                                        className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                        onChange={e=>setParentRegData({...parentRegData, studentsCount: e.target.value})}
                                    >
                                        <option value="1">Ø·Ø§Ù„Ø¨ ÙˆØ§Ø­Ø¯</option>
                                        <option value="2">Ø·Ø§Ù„Ø¨ÙŠÙ†</option>
                                        <option value="3">3 Ø·Ù„Ø§Ø¨</option>
                                        <option value="4">4 Ø·Ù„Ø§Ø¨</option>
                                        <option value="5">5 Ø·Ù„Ø§Ø¨ Ø£Ùˆ Ø£ÙƒØ«Ø±</option>
                                    </select>
                                </div>

                                <textarea 
                                    className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white" 
                                    placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" 
                                    rows="3"
                                    onChange={e=>setParentRegData({...parentRegData, notes: e.target.value})}
                                />

                                <div className="bg-blue-500/10 border border-blue-500/30 p-4 rounded-xl">
                                    <p className="text-sm text-blue-300">
                                        <SafeIcon name="info" className="inline mr-2"/> Ù…Ù„Ø§Ø­Ø¸Ø©:
                                    </p>
                                    <p className="text-xs text-slate-400 mt-1">
                                        Ø¨Ø¹Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ØŒ Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø®Ø§Øµ Ù„Ùƒ. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù„Ø¯Ø®ÙˆÙ„ ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø£Ø¨Ù†Ø§Ø¦Ùƒ.
                                        Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªÙ‚Ø¯ÙŠÙ… ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨ (Ø§Ù„Ø°ÙŠ Ø³ÙŠØ­ØµÙ„ Ø¹Ù„ÙŠÙ‡ Ø§Ø¨Ù†Ùƒ) Ù„Ø±Ø¨Ø·Ù‡ Ø¨Ø­Ø³Ø§Ø¨Ùƒ.
                                    </p>
                                </div>
                            </div>
                        )}

                        <div className="bg-blue-500/10 border border-blue-500/30 p-4 rounded-xl mt-6">
                            <p className="text-sm text-blue-300 mb-2">
                                <SafeIcon name="info" className="inline mr-2"/> Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©:
                            </p>
                            <p className="text-xs text-slate-400">
                                Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø­Ù…ÙŠØ© ÙˆÙ„Ù† ÙŠØªÙ… Ù…Ø´Ø§Ø±ÙƒØªÙ‡Ø§ Ù…Ø¹ Ø£ÙŠ Ø¬Ù‡Ø© Ø®Ø§Ø±Ø¬ÙŠØ©. ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙ‚Ø· Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ù…Ù†ØµØ©.
                            </p>
                        </div>

                        <div className="flex gap-4 mt-6">
                            <button 
                                onClick={()=>submitRegistration(registrationType)} 
                                className="btn-main flex-1 py-4 rounded-xl text-lg font-bold flex items-center justify-center gap-2"
                            >
                                <SafeIcon name="send"/> Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                            </button>
                            <button 
                                onClick={()=>setView('choose-role')} 
                                className="px-6 py-4 bg-white/10 hover:bg-white/20 rounded-xl font-bold transition"
                            >
                                Ø±Ø¬ÙˆØ¹
                            </button>
                        </div>
                    </div>
                </div>
            );

            // ğŸ” ØµÙØ­Ø© Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
            if (view === 'admin-login') return (
                <div className="min-h-screen bg-brand-dark flex items-center justify-center p-4">
                    <div className="glass-panel p-8 w-full max-w-md animate-slide-up">
                        <div className="text-center mb-8">
                            <div className="w-20 h-20 bg-red-600/20 rounded-full flex items-center justify-center mx-auto mb-4">
                                <SafeIcon name="shield" size={40} className="text-red-400"/>
                            </div>
                            <h2 className="text-3xl font-bold text-white mb-2">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
                            <p className="text-slate-400">Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ§Ù„Ù…Ø¯Ø±Ø³ÙŠÙ† ÙÙ‚Ø·</p>
                        </div>

                        <div className="space-y-6">
                            <div className="bg-red-600/10 border border-red-500/30 p-4 rounded-xl">
                                <p className="text-sm text-red-300 mb-2">
                                    <SafeIcon name="alert-circle" className="inline mr-2"/> ØªÙ†Ø¨ÙŠÙ‡:
                                </p>
                                <p className="text-xs text-slate-400">
                                    Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ù…Ø®ØµØµØ© Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙÙ‚Ø·. ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù„Ø¯ÙŠÙƒ ÙƒÙˆØ¯ Ø®Ø§Øµ Ù„Ù„Ø¯Ø®ÙˆÙ„.
                                </p>
                            </div>

                            <input 
                                className="w-full p-4 bg-white/5 border border-white/10 rounded-xl outline-none text-white text-center text-xl tracking-widest font-mono" 
                                placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©" 
                                value={adminLoginCode}
                                onChange={e=>setAdminLoginCode(e.target.value.toUpperCase())}
                                maxLength="20"
                            />
                            
                            <button 
                                onClick={handleAdminLogin} 
                                className="btn-main w-full py-4 rounded-xl text-lg font-bold flex items-center justify-center gap-2"
                            >
                                <SafeIcon name="shield"/> Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                            </button>
                            
                            <div className="text-center">
                                <p className="text-slate-500 text-sm mb-2">Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ÙƒÙˆØ¯ Ø¥Ø¯Ø§Ø±Ø©ØŸ</p>
                                <button onClick={()=>setView('landing')} 
                                        className="text-brand-accent hover:underline">
                                    Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // ğŸ‘¨â€ğŸ‘¦ ØµÙØ­Ø© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
            if (view === 'parent') {
                const selectedStudentId = parentView.startsWith('student-') ? parentView.replace('student-', '') : null;
                const selectedStudentData = linkedStudents.find(s => s.id === selectedStudentId);
                
                return (
                    <div className="min-h-screen bg-brand-dark text-white flex flex-col md:flex-row">
                        {/* Sidebar */}
                        <aside className={`fixed inset-y-0 right-0 z-50 w-72 bg-brand-card border-l border-white/5 flex flex-col transition-transform duration-300 ${sidebarOpen ? 'translate-x-0' : 'translate-x-full'} md:translate-x-0 md:static shrink-0`}>
                            <div className="p-6 text-center border-b border-white/5">
                                <div className="relative inline-block">
                                    <img src={user.photo} className="w-20 h-20 rounded-full border-4 border-brand-dark mx-auto mb-3"/>
                                    <div className={`absolute bottom-2 right-0 w-5 h-5 rounded-full border-2 border-brand-card bg-green-500`}></div>
                                </div>
                                <h3 className="font-bold text-lg">{user.name}</h3>
                                <p className="text-xs text-slate-400 font-mono mt-1">{user.code}</p>
                                <div className="mt-2">
                                    <span className="badge-parent">ÙˆÙ„ÙŠ Ø£Ù…Ø±</span>
                                </div>
                                <div className="mt-2 text-sm text-slate-400">
                                    <SafeIcon name="users" className="inline mr-1"/>
                                    {linkedStudents.length} Ø·Ø§Ù„Ø¨ Ù…Ø±ØªØ¨Ø·
                                </div>
                            </div>

                            <nav className="p-4 space-y-2 flex-1">
                                <button onClick={()=>setParentView('overview')} 
                                        className={`w-full flex items-center gap-3 p-3 rounded-xl transition font-bold ${parentView==='overview' ? 'bg-green-500 text-white' : 'text-slate-400 hover:bg-white/5 hover:text-white'}`}>
                                    <SafeIcon name="home" size={20}/> Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©
                                </button>
                                
                                <div className="text-xs text-slate-500 mt-4 mb-2 px-3">Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø±ØªØ¨Ø·ÙŠÙ†:</div>
                                
                                {linkedStudents.length === 0 ? (
                                    <div className="text-center p-4 text-slate-500 text-sm">
                                        <SafeIcon name="users" size={24} className="mx-auto mb-2 opacity-50"/>
                                        Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø§Ø¨ Ù…Ø±ØªØ¨Ø·ÙŠÙ†
                                    </div>
                                ) : (
                                    linkedStudents.map(student => (
                                        <button key={student.id} onClick={()=>setParentView(`student-${student.id}`)}
                                                className={`w-full flex items-center gap-3 p-3 rounded-xl transition font-bold ${parentView===`student-${student.id}` ? 'bg-blue-500/20 text-blue-300 border border-blue-500/30' : 'text-slate-400 hover:bg-white/5 hover:text-white'}`}>
                                            <img src={student.photo} className="w-8 h-8 rounded-full"/>
                                            <div className="text-right">
                                                <div className="font-bold text-sm">{student.firstName} {student.secondName}</div>
                                                <div className="text-xs text-slate-500">{student.grade === '1sec' ? 'Ø£ÙˆÙ„' : student.grade === '2sec' ? 'Ø«Ø§Ù†ÙŠ' : 'Ø«Ø§Ù„Ø«'} Ø«Ø§Ù†ÙˆÙŠ</div>
                                            </div>
                                        </button>
                                    ))
                                )}
                                
                                <div className="border-t border-white/5 pt-4 mt-4">
                                    <button onClick={()=>setParentView('link-student')} 
                                            className="w-full flex items-center gap-3 p-3 rounded-xl transition font-bold text-green-400 hover:bg-green-500/10">
                                        <SafeIcon name="link" size={20}/> Ø±Ø¨Ø· Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
                                    </button>
                                    <button onClick={()=>setParentView('settings')} 
                                            className="w-full flex items-center gap-3 p-3 rounded-xl transition font-bold text-slate-400 hover:bg-white/5">
                                        <SafeIcon name="settings" size={20}/> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                                    </button>
                                </div>
                            </nav>

                            <div className="p-4 border-t border-white/5 space-y-2">
                                <a href={CONTACT_INFO.supportWhatsapp} target="_blank" 
                                   className="flex items-center justify-center gap-2 bg-blue-600/20 border border-blue-500/30 text-blue-300 w-full p-3 rounded-xl font-bold hover:bg-blue-600/40 transition">
                                    <SafeIcon name="headphones" size={18}/> Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                                </a>
                                <button onClick={()=>window.authMethods.signOut(window.auth)} 
                                        className="flex items-center justify-center gap-2 text-red-400 w-full p-3 hover:bg-red-500/10 rounded-xl font-bold transition">
                                    <SafeIcon name="logout" size={18}/> Ø®Ø±ÙˆØ¬
                                </button>
                            </div>
                        </aside>

                        {/* Main Content */}
                        <div className="flex-1 flex flex-col h-screen overflow-y-auto bg-brand-dark relative">
                            <div className="absolute inset-0 math-grid opacity-10 pointer-events-none"></div>
                            
                            <header className="p-4 flex justify-between items-center md:hidden sticky top-0 z-40 bg-brand-dark/80 backdrop-blur-md border-b border-white/5">
                                <h1 className="font-black text-xl text-green-400">ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</h1>
                                <button onClick={()=>setSidebarOpen(true)}><SafeIcon name="menu" className="text-white"/></button>
                            </header>

                            <main className="p-4 md:p-8 max-w-6xl mx-auto w-full relative z-10">
                                {/* Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© */}
                                {parentView === 'overview' && (
                                    <div className="space-y-6 animate-slide-up">
                                        <div className="bg-gradient-to-r from-green-500 to-emerald-900 rounded-2xl p-8 relative overflow-hidden shadow-2xl">
                                            <div className="relative z-10">
                                                <h2 className="text-3xl font-black mb-2">Ø£Ù‡Ù„Ø§Ù‹ {user.name} ğŸ‘¨â€ğŸ‘¦</h2>
                                                <p className="text-emerald-100 mb-6">Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</p>
                                                <div className="flex flex-wrap gap-4">
                                                    <div className="bg-black/30 px-4 py-2 rounded-lg flex items-center gap-2 border border-white/10">
                                                        <SafeIcon name="users" size={16} className="text-green-400"/> {linkedStudents.length} Ø·Ø§Ù„Ø¨ Ù…Ø±ØªØ¨Ø·
                                                    </div>
                                                    <div className="bg-black/30 px-4 py-2 rounded-lg flex items-center gap-2 border border-white/10">
                                                        <SafeIcon name="calendar-check" size={16} className="text-blue-400"/> {linkedStudents.reduce((acc, s) => acc + Object.keys(dataState.attendance[s.id] || {}).length, 0)} ÙŠÙˆÙ… Ø­Ø¶ÙˆØ±
                                                    </div>
                                                    <div className="bg-black/30 px-4 py-2 rounded-lg flex items-center gap-2 border border-white/10">
                                                        <SafeIcon name="trending-up" size={16} className="text-yellow-400"/> {linkedStudents.reduce((acc, s) => acc + (s.examsCompleted || 0), 0)} Ø§Ù…ØªØ­Ø§Ù† Ù…ÙƒØªÙ…Ù„
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        {/* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ */}
                                        <div className="glass-panel p-6">
                                            <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
                                                <SafeIcon name="users" className="text-green-400"/> Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø±ØªØ¨Ø·ÙŠÙ†
                                            </h3>
                                            
                                            {linkedStudents.length === 0 ? (
                                                <div className="text-center py-8">
                                                    <SafeIcon name="users" size={48} className="mx-auto text-gray-400 mb-3"/>
                                                    <p className="text-slate-500 font-bold mb-4">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø§Ø¨ Ù…Ø±ØªØ¨Ø·ÙŠÙ†</p>
                                                    <button onClick={()=>setParentView('link-student')} 
                                                            className="btn-main px-6 py-2">
                                                        Ø±Ø¨Ø· Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
                                                    </button>
                                                </div>
                                            ) : (
                                                <div className="grid md:grid-cols-2 gap-4">
                                                    {linkedStudents.map(student => {
                                                        const attendanceCount = Object.keys(dataState.attendance[student.id] || {}).length;
                                                        const subscriptionDays = calculateSubscriptionDays(dataState.subscriptions[student.id]?.endDate);
                                                        const lastExam = dataState.exams.filter(e => e.studentId === student.id).slice(-1)[0];
                                                        
                                                        return (
                                                            <div key={student.id} className="bg-white/5 p-4 rounded-xl hover:bg-white/10 transition cursor-pointer" onClick={()=>setParentView(`student-${student.id}`)}>
                                                                <div className="flex items-center gap-3 mb-3">
                                                                    <img src={student.photo} className="w-12 h-12 rounded-full"/>
                                                                    <div>
                                                                        <h4 className="font-bold">{student.firstName} {student.secondName}</h4>
                                                                        <p className="text-xs text-slate-500">{student.code}</p>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div className="space-y-2 text-sm">
                                                                    <div className="flex justify-between">
                                                                        <span className="text-slate-400">Ø§Ù„ØµÙ:</span>
                                                                        <span className="font-bold">{student.grade === '1sec' ? 'Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ' : student.grade === '2sec' ? 'Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ' : 'Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ'}</span>
                                                                    </div>
                                                                    <div className="flex justify-between">
                                                                        <span className="text-slate-400">Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±:</span>
                                                                        <span className="font-bold text-green-400">{attendanceCount}</span>
                                                                    </div>
                                                                    <div className="flex justify-between">
                                                                        <span className="text-slate-400">Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ:</span>
                                                                        <span className={`font-bold ${subscriptionDays > 0 ? 'text-green-400' : 'text-red-400'}`}>
                                                                            {subscriptionDays > 0 ? `Ø¨Ø§Ù‚ÙŠ ${subscriptionDays} ÙŠÙˆÙ…` : 'Ù…Ù†ØªÙ‡ÙŠ'}
                                                                        </span>
                                                                    </div>
                                                                    {student.notes && (
                                                                        <div className="mt-2 p-2 bg-yellow-500/10 rounded text-xs text-yellow-300">
                                                                            Ù…Ù„Ø§Ø­Ø¸Ø©: {student.notes.substring(0, 60)}...
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            </div>
                                                        );
                                                    })}
                                                </div>
                                            )}
                                        </div>

                                        {/* Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ù‡Ù…Ø© */}
                                        <div className="glass-panel p-6">
                                            <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
                                                <SafeIcon name="bell" className="text-yellow-400"/> ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ù‡Ù…Ø©
                                            </h3>
                                            <div className="space-y-3">
                                                {linkedStudents.map(student => {
                                                    const subscriptionDays = calculateSubscriptionDays(dataState.subscriptions[student.id]?.endDate);
                                                    const lastAttendance = Object.keys(dataState.attendance[student.id] || {}).length;
                                                    const today = new Date();
                                                    const lastWeek = new Date(today.setDate(today.getDate() - 7));
                                                    
                                                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø´Ø§ÙƒÙ„
                                                    const issues = [];
                                                    
                                                    if (subscriptionDays <= 3 && subscriptionDays > 0) {
                                                        issues.push(`Ø§Ø´ØªØ±Ø§Ùƒ ${student.firstName} ÙŠÙ†ØªÙ‡ÙŠ Ø®Ù„Ø§Ù„ ${subscriptionDays} Ø£ÙŠØ§Ù…`);
                                                    }
                                                    
                                                    if (subscriptionDays <= 0) {
                                                        issues.push(`Ø§Ø´ØªØ±Ø§Ùƒ ${student.firstName} Ù…Ù†ØªÙ‡ÙŠ`);
                                                    }
                                                    
                                                    if (lastAttendance < 2) {
                                                        issues.push(`${student.firstName} Ù„Ø¯ÙŠÙ‡ Ø­Ø¶ÙˆØ± Ù‚Ù„ÙŠÙ„`);
                                                    }
                                                    
                                                    return issues.length > 0 ? (
                                                        <div key={student.id} className="bg-red-500/10 border border-red-500/30 p-3 rounded-lg">
                                                            <h4 className="font-bold text-red-400 mb-2">{student.firstName} {student.secondName}</h4>
                                                            <ul className="space-y-1 text-sm text-red-300">
                                                                {issues.map((issue, idx) => (
                                                                    <li key={idx} className="flex items-center gap-2">
                                                                        <SafeIcon name="alert-circle" size={12}/>
                                                                        {issue}
                                                                    </li>
                                                                ))}
                                                            </ul>
                                                        </div>
                                                    ) : null;
                                                }).filter(Boolean)}
                                                
                                                {linkedStudents.length === 0 && (
                                                    <p className="text-center text-slate-500 py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* ØªÙØ§ØµÙŠÙ„ Ø·Ø§Ù„Ø¨ Ù…Ø­Ø¯Ø¯ */}
                                {selectedStudentData && parentView === `student-${selectedStudentData.id}` && (
                                    <div className="space-y-6 animate-slide-up">
                                        <div className="flex items-center justify-between mb-6">
                                            <button onClick={()=>setParentView('overview')} 
                                                    className="flex items-center gap-2 text-slate-400 hover:text-white font-bold transition">
                                                <SafeIcon name="arrow-right"/> Ø±Ø¬ÙˆØ¹
                                            </button>
                                            <h2 className="text-2xl font-bold">Ù…ØªØ§Ø¨Ø¹Ø©: {selectedStudentData.firstName} {selectedStudentData.secondName}</h2>
                                        </div>

                                        {/* Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ */}
                                        <div className="grid md:grid-cols-3 gap-6">
                                            <div className="glass-panel p-6">
                                                <h3 className="font-bold mb-4 text-green-400">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h3>
                                                <div className="space-y-3">
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-400">Ø§Ù„ÙƒÙˆØ¯:</span>
                                                        <span className="font-bold">{selectedStudentData.code}</span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-400">Ø§Ù„ØµÙ:</span>
                                                        <span className="font-bold">{selectedStudentData.grade === '1sec' ? 'Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ' : selectedStudentData.grade === '2sec' ? 'Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ' : 'Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ'}</span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-400">Ø§Ù„Ù…Ø¯Ø±Ø³Ø©:</span>
                                                        <span className="font-bold">{selectedStudentData.school}</span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-400">Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</span>
                                                        <span className="font-bold">{selectedStudentData.phone}</span>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Ø§Ù„Ø­Ø¶ÙˆØ± */}
                                            <div className="glass-panel p-6">
                                                <h3 className="font-bold mb-4 text-blue-400">Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨</h3>
                                                <div className="space-y-3">
                                                    <div className="flex justify-between items-center">
                                                        <span className="text-slate-400">Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±:</span>
                                                        <span className="text-2xl font-bold text-green-400">
                                                            {Object.keys(dataState.attendance[selectedStudentData.id] || {}).length}
                                                        </span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-slate-400">Ø§Ù„ØºÙŠØ§Ø¨:</span>
                                                        <span className="font-bold text-red-400">{selectedStudentData.absences || 0}</span>
                                                    </div>
                                                    <div className="mt-4">
                                                        <div className="text-xs text-slate-400 mb-1">Ø¢Ø®Ø± 7 Ø£ÙŠØ§Ù…:</div>
                                                        <div className="flex gap-1">
                                                            {Array.from({length: 7}).map((_, i) => {
                                                                const date = new Date();
                                                                date.setDate(date.getDate() - i);
                                                                const dateStr = date.toISOString().split('T')[0];
                                                                const hasAttendance = dataState.attendance[selectedStudentData.id]?.[dateStr];
                                                                
                                                                return (
                                                                    <div key={i} className={`flex-1 h-6 rounded ${hasAttendance ? 'bg-green-500' : 'bg-red-500/30'}`}></div>
                                                                );
                                                            })}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ */}
                                            <div className="glass-panel p-6">
                                                <h3 className="font-bold mb-4 text-yellow-400">Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h3>
                                                <div className="space-y-3">
                                                    <div className="flex justify-between items-center">
                                                        <span className="text-slate-400">Ø§Ù„Ø­Ø§Ù„Ø©:</span>
                                                        <span className={`px-3 py-1 rounded-full text-sm font-bold ${selectedStudentData.isPaid ? 'bg-green-500/20 text-green-300' : 'bg-red-500/20 text-red-300'}`}>
                                                            {selectedStudentData.isPaid ? 'Ù…ÙØ¹Ù„' : 'ØºÙŠØ± Ù…ÙØ¹Ù„'}
                                                        </span>
                                                    </div>
                                                    {dataState.subscriptions[selectedStudentData.id] && (
                                                        <>
                                                            <div className="flex justify-between">
                                                                <span className="text-slate-400">Ø¨Ø¯Ø£ ÙÙŠ:</span>
                                                                <span className="font-bold">
                                                                    {new Date(dataState.subscriptions[selectedStudentData.id].startDate).toLocaleDateString('ar-EG')}
                                                                </span>
                                                            </div>
                                                            <div className="flex justify-between">
                                                                <span className="text-slate-400">ÙŠÙ†ØªÙ‡ÙŠ ÙÙŠ:</span>
                                                                <span className="font-bold">
                                                                    {new Date(dataState.subscriptions[selectedStudentData.id].endDate).toLocaleDateString('ar-EG')}
                                                                </span>
                                                            </div>
                                                            <div className="flex justify-between">
                                                                <span className="text-slate-400">Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©:</span>
                                                                <span className={`font-bold ${calculateSubscriptionDays(dataState.subscriptions[selectedStudentData.id].endDate) > 7 ? 'text-green-400' : 'text-red-400'}`}>
                                                                    {calculateSubscriptionDays(dataState.subscriptions[selectedStudentData.id].endDate)} ÙŠÙˆÙ…
                                                                </span>
                                                            </div>
                                                        </>
                                                    )}
                                                </div>
                                            </div>
                                        </div>

                                        {/* Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ */}
                                        <div className="glass-panel p-6">
                                            <h3 className="font-bold mb-4 text-purple-400">Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</h3>
                                            <div className="space-y-4">
                                                <div className="grid md:grid-cols-3 gap-4">
                                                    <div className="bg-white/5 p-4 rounded-xl text-center">
                                                        <div className="text-2xl font-bold text-green-400 mb-1">
                                                            {selectedStudentData.examsCompleted || 0}
                                                        </div>
                                                        <div className="text-xs text-slate-400">Ø§Ù…ØªØ­Ø§Ù† Ù…ÙƒØªÙ…Ù„</div>
                                                    </div>
                                                    <div className="bg-white/5 p-4 rounded-xl text-center">
                                                        <div className="text-2xl font-bold text-blue-400 mb-1">
                                                            {selectedStudentData.avgScore ? `${selectedStudentData.avgScore}%` : '--'}
                                                        </div>
                                                        <div className="text-xs text-slate-400">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¯Ø±Ø¬Ø§Øª</div>
                                                    </div>
                                                    <div className="bg-white/5 p-4 rounded-xl text-center">
                                                        <div className="text-2xl font-bold text-yellow-400 mb-1">
                                                            {selectedStudentData.questionsAsked || 0}
                                                        </div>
                                                        <div className="text-xs text-slate-400">Ø³Ø¤Ø§Ù„ Ù…Ø·Ø±ÙˆØ­</div>
                                                    </div>
                                                </div>
                                                
                                                {selectedStudentData.notes && (
                                                    <div className="bg-yellow-500/10 border border-yellow-500/30 p-4 rounded-xl mt-4">
                                                        <h4 className="font-bold text-yellow-400 mb-2">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù† Ø§Ù„Ù…Ø³ØªØ±:</h4>
                                                        <p className="text-slate-300">{selectedStudentData.notes}</p>
                                                    </div>
                                                )}
                                            </div>
                                        </div>

                                        {/* Ø²Ø± Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© */}
                                        <div className="glass-panel p-6 text-center">
                                            <h3 className="font-bold mb-4">Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
                                            <p className="text-slate-400 mb-4">Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø£Ùˆ Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø£Ø®Ø±Ù‰</p>
                                            <a href={`${CONTACT_INFO.supportWhatsapp}?text=Ø£Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø§Ù„Ø·Ø§Ù„Ø¨: ${selectedStudentData.firstName} ${selectedStudentData.secondName} - ÙƒÙˆØ¯: ${selectedStudentData.code}`} 
                                               target="_blank"
                                               className="inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition">
                                                <SafeIcon name="message-circle"/> ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù„Ù‰ WhatsApp
                                            </a>
                                        </div>
                                    </div>
                                )}

                                {/* Ø±Ø¨Ø· Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ */}
                                {parentView === 'link-student' && (
                                    <div className="max-w-2xl mx-auto animate-slide-up">
                                        <div className="flex items-center justify-between mb-6">
                                            <button onClick={()=>setParentView('overview')} 
                                                    className="flex items-center gap-2 text-slate-400 hover:text-white font-bold transition">
                                                <SafeIcon name="arrow-right"/> Ø±Ø¬ÙˆØ¹
                                            </button>
                                            <h2 className="text-2xl font-bold">Ø±Ø¨Ø· Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h2>
                                        </div>

                                        <div className="glass-panel p-6">
                                            <h3 className="font-bold mb-4 text-green-400">ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø±Ø¨Ø·</h3>
                                            <div className="space-y-3 text-sm text-slate-300 mb-6">
                                                <p>Ù„Ø±Ø¨Ø· Ø·Ø§Ù„Ø¨ Ø¨Ø­Ø³Ø§Ø¨ÙƒØŒ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ†:</p>
                                                <ul className="space-y-2 mr-4">
                                                    <li className="flex items-center gap-2">
                                                        <SafeIcon name="check-circle" className="text-green-500"/>
                                                        Ù…Ø³Ø¬Ù„ ÙÙŠ Ø§Ù„Ù…Ù†ØµØ© ÙƒØ·Ø§Ù„Ø¨
                                                    </li>
                                                    <li className="flex items-center gap-2">
                                                        <SafeIcon name="check-circle" className="text-green-500"/>
                                                        Ù„Ø¯ÙŠÙ‡ ÙƒÙˆØ¯ Ø·Ø§Ù„Ø¨ ØµØ§Ù„Ø­
                                                    </li>
                                                    <li className="flex items-center gap-2">
                                                        <SafeIcon name="check-circle" className="text-green-500"/>
                                                        Ù…ÙØ¹Ù„ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                                                    </li>
                                                </ul>
                                            </div>

                                            <div className="space-y-4">
                                                <div>
                                                    <label className="block text-sm text-slate-400 mb-2">ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨</label>
                                                    <input 
                                                        type="text"
                                                        id="studentCodeToLink"
                                                        className="w-full p-3 bg-white/5 border border-white/10 rounded-xl outline-none text-white text-center text-lg font-mono"
                                                        placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨"
                                                    />
                                                </div>

                                                <div>
                                                    <label className="block text-sm text-slate-400 mb-2">Ø¹Ù„Ø§Ù‚Ø© Ø§Ù„Ù‚Ø±Ø§Ø¨Ø©</label>
                                                    <select 
                                                        id="relationshipType"
                                                        className="w-full p-3 bg-white/5 border border-white/10 rounded-xl outline-none text-white"
                                                    >
                                                        <option value="Ø§Ø¨Ù†/Ø§Ø¨Ù†Ø©">Ø§Ø¨Ù†/Ø§Ø¨Ù†Ø©</option>
                                                        <option value="Ø£Ø®/Ø£Ø®Øª">Ø£Ø®/Ø£Ø®Øª</option>
                                                        <option value="Ù‚Ø±ÙŠØ¨">Ù‚Ø±ÙŠØ¨</option>
                                                        <option value="ÙˆØµÙŠ">ÙˆØµÙŠ</option>
                                                        <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                                                    </select>
                                                </div>

                                                <button onClick={()=>{
                                                    const studentCode = document.getElementById('studentCodeToLink').value;
                                                    const relationship = document.getElementById('relationshipType').value;
                                                    
                                                    if (!studentCode) {
                                                        return showNotification('Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨', 'error');
                                                    }
                                                    
                                                    const student = dataState.students.find(s => s.code === studentCode);
                                                    if (!student) {
                                                        return showNotification('ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨ ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
                                                    }
                                                    
                                                    if (student.status !== 'active') {
                                                        return showNotification('Ø­Ø³Ø§Ø¨ Ø§Ù„Ø·Ø§Ù„Ø¨ ØºÙŠØ± Ù…ÙØ¹Ù„', 'error');
                                                    }
                                                    
                                                    // Ø±Ø¨Ø· Ø§Ù„Ø·Ø§Ù„Ø¨
                                                    linkStudentToParent(user.uid, student.id, relationship);
                                                    document.getElementById('studentCodeToLink').value = '';
                                                    
                                                }} className="btn-main w-full py-3 rounded-xl font-bold">
                                                    Ø±Ø¨Ø· Ø§Ù„Ø·Ø§Ù„Ø¨
                                                </button>
                                            </div>

                                            <div className="bg-blue-500/10 border border-blue-500/30 p-4 rounded-xl mt-6">
                                                <p className="text-sm text-blue-300 mb-2">
                                                    <SafeIcon name="info" className="inline mr-2"/> Ù…Ù„Ø§Ø­Ø¸Ø©:
                                                </p>
                                                <p className="text-xs text-slate-400">
                                                    Ø¨Ø¹Ø¯ Ø§Ù„Ø±Ø¨Ø·ØŒ Ø³ÙŠØªÙ…ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ù† Ø±Ø¤ÙŠØ© Ø£Ù†Ùƒ Ù…Ø±ØªØ¨Ø· Ø¨Ù‡. ÙŠÙ…ÙƒÙ†Ùƒ Ø·Ù„Ø¨ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±Ø¨Ø· Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </main>
                        </div>
                    </div>
                );
            }

            // ğŸ‘‘ Admin View - Ù…Ø­Ø¯Ø« Ù…Ø¹ Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
            if (view === 'admin') {
                const filteredStudents = dataState.students.filter(s => 
                    s.name?.toLowerCase().includes(searchQuery.toLowerCase()) ||
                    s.code?.toLowerCase().includes(searchQuery.toLowerCase()) ||
                    s.phone?.includes(searchQuery)
                );

                return (
                    <div className="min-h-screen bg-brand-dark p-4 md:p-6">
                        <div className="max-w-7xl mx-auto glass-panel p-6 md:p-8">
                            <div className="flex flex-wrap justify-between items-center mb-8 pb-4 border-b border-white/10 gap-4">
                                <div>
                                    <h2 className="text-3xl font-black text-brand-accent">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø´Ø§Ù…Ù„Ø©</h2>
                                    <div className="flex items-center gap-3 mt-2">
                                        <span className={`role-badge ${user.role === 'boss' ? 'badge-boss' : 'badge-admin'}`}>
                                            {user.role === 'boss' ? 'Ø§Ù„Ø¨ÙˆØµ' : 'Ø£Ø¯Ù…Ù†'}
                                        </span>
                                        <span className="text-slate-400 text-sm">{user.adminLevel || user.name}</span>
                                    </div>
                                </div>
                                <div className="flex gap-3 flex-wrap">
                                    <button onClick={showAdminCodes} 
                                            className="px-4 py-2 bg-purple-600 rounded-lg font-bold hover:bg-purple-700 flex items-center gap-2">
                                        <SafeIcon name="key" size={18}/>
                                        Ø¹Ø±Ø¶ Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                                    </button>
                                    {user.role === 'boss' && (
                                        <button onClick={()=>{
                                            // ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯ Ø¬Ø¯ÙŠØ¯Ø©
                                            const newCodes = {
                                                'BOSS': {
                                                    code: generateRandomCode('BOSS'),
                                                    role: 'boss',
                                                    name: 'Ø§Ù„Ø¨ÙˆØµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ'
                                                },
                                                'ADMIN_1': {
                                                    code: generateRandomCode('ADMIN'),
                                                    role: 'admin',
                                                    name: 'Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø£ÙˆÙ„'
                                                },
                                                'ADMIN_2': {
                                                    code: generateRandomCode('ADMIN'),
                                                    role: 'admin',
                                                    name: 'Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø«Ø§Ù†ÙŠ'
                                                },
                                                'ADMIN_3': {
                                                    code: generateRandomCode('ADMIN'),
                                                    role: 'admin',
                                                    name: 'Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø«Ø§Ù„Ø«'
                                                }
                                            };
                                            
                                            localStorage.setItem('ADMIN_CODES', JSON.stringify(newCodes));
                                            showNotification('ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯ Ø¥Ø¯Ø§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©', 'success');
                                        }} 
                                                className="px-4 py-2 bg-red-600 rounded-lg font-bold hover:bg-red-700 flex items-center gap-2">
                                            <SafeIcon name="refresh" size={18}/>
                                            ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯ Ø¬Ø¯ÙŠØ¯Ø©
                                        </button>
                                    )}
                                    <button onClick={()=>window.authMethods.signOut(window.auth)} 
                                            className="px-4 py-2 bg-red-600 rounded-lg font-bold hover:bg-red-700">
                                        Ø®Ø±ÙˆØ¬
                                    </button>
                                </div>
                            </div>

                            {/* Stats */}
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                                <div className="bg-white/5 p-4 rounded-xl border border-white/5">
                                    <div className="text-slate-400 text-xs mb-1">Ø§Ù„Ø·Ù„Ø§Ø¨</div>
                                    <div className="text-2xl font-black">{dataState.students.length}</div>
                                </div>
                                <div className="bg-white/5 p-4 rounded-xl border border-white/5">
                                    <div className="text-slate-400 text-xs mb-1">Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</div>
                                    <div className="text-2xl font-black text-green-400">{dataState.parents.length}</div>
                                </div>
                                <div className="bg-white/5 p-4 rounded-xl border border-white/5">
                                    <div className="text-slate-400 text-xs mb-1">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
                                    <div className="text-2xl font-black text-orange-400">{dataState.requests.length}</div>
                                </div>
                                <div className="bg-white/5 p-4 rounded-xl border border-white/5">
                                    <div className="text-slate-400 text-xs mb-1">Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª</div>
                                    <div className="text-2xl font-black text-brand-accent">{dataState.lectures.length}</div>
                                </div>
                            </div>

                            {/* Tabs */}
                            <div className="flex gap-2 mb-6 overflow-x-auto pb-2">
                                {['students', 'parents', 'lectures', 'payments', 'attendance', 'connections', 'settings'].map(t => (
                                    <button key={t} onClick={()=>setActiveTab(t)} 
                                            className={`px-6 py-2 rounded-lg font-bold whitespace-nowrap transition ${activeTab === t ? 'bg-brand-accent text-brand-dark' : 'bg-white/5 text-slate-400 hover:bg-white/10'}`}>
                                        {t === 'students' ? 'Ø§Ù„Ø·Ù„Ø§Ø¨' : 
                                         t === 'parents' ? 'Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±' : 
                                         t === 'lectures' ? 'Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª' : 
                                         t === 'payments' ? 'Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª' :
                                         t === 'attendance' ? 'Ø§Ù„Ø­Ø¶ÙˆØ±' :
                                         t === 'connections' ? 'Ø§Ù„Ø±ÙˆØ§Ø¨Ø·' :
                                         t === 'settings' ? 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª' : ''}
                                    </button>
                                ))}
                            </div>

                            {/* Content */}
                            <div className="bg-brand-dark/50 p-6 rounded-2xl border border-white/5 min-h-[400px]">
                                
                                {/* Students Tab */}
                                {activeTab === 'students' && (
                                    <div>
                                        {/* Pending Requests */}
                                        {dataState.requests.length > 0 && (
                                            <div className="mb-8 bg-orange-500/10 border border-orange-500/30 p-4 rounded-xl">
                                                <h3 className="font-bold text-orange-400 mb-3 flex items-center gap-2">
                                                    <SafeIcon name="user-plus"/> Ø·Ù„Ø¨Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø§Ø¨ Ø¬Ø¯ÙŠØ¯Ø© ({dataState.requests.length})
                                                </h3>
                                                <div className="space-y-2">
                                                    {dataState.requests.map(r => (
                                                        <div key={r.id} className="flex flex-col md:flex-row justify-between items-start md:items-center bg-black/20 p-3 rounded-lg gap-3">
                                                            <div className="flex gap-3 items-center">
                                                                <img src={r.photo} className="w-10 h-10 rounded-full"/>
                                                                <div>
                                                                    <p className="font-bold">{r.name}</p>
                                                                    <p className="text-xs text-slate-400">ğŸ“± {r.phone} | ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ {r.parentPhone}</p>
                                                                    <p className="text-xs text-slate-400">ğŸ« {r.school} | ğŸ“ {r.governorate}, {r.city}</p>
                                                                    <p className="text-xs text-slate-400">ğŸ“ {r.grade === '1sec' ? 'Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ' : r.grade === '2sec' ? 'Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ' : 'Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ'}</p>
                                                                </div>
                                                            </div>
                                                            <div className="flex gap-2">
                                                                <button onClick={async()=>{
                                                                    const studentCode = generateStudentCode();
                                                                    const studentData = {
                                                                        ...r,
                                                                        firstName: r.firstName,
                                                                        secondName: r.secondName,
                                                                        thirdName: r.thirdName,
                                                                        role: 'student',
                                                                        code: studentCode,
                                                                        isPaid: false,
                                                                        absences: 0,
                                                                        status: 'active'
                                                                    };
                                                                    
                                                                    await window.rtdb.set(window.rtdb.ref(window.db,'users/'+r.uid), studentData);
                                                                    await window.rtdb.set(window.rtdb.ref(window.db,'requests/'+r.id), null);
                                                                    
                                                                    sendWhatsAppToStudent(studentData);
                                                                    
                                                                    showNotification(`ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯: ${studentCode}`);
                                                                }} className="bg-green-600 px-3 py-1 rounded text-sm hover:bg-green-700">Ù‚Ø¨ÙˆÙ„</button>
                                                                <button onClick={()=>window.rtdb.set(window.rtdb.ref(window.db,'requests/'+r.id), null)} 
                                                                        className="bg-red-600 px-3 py-1 rounded text-sm hover:bg-red-700">Ø±ÙØ¶</button>
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        )}

                                        {/* Search */}
                                        <div className="flex gap-2 mb-4">
                                            <input className="flex-1 bg-black/30 border border-white/10 p-3 rounded-xl outline-none" 
                                                   placeholder="Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ØŒ Ø§Ù„ÙƒÙˆØ¯ Ø£Ùˆ Ø§Ù„Ø±Ù‚Ù…..." 
                                                   value={searchQuery} 
                                                   onChange={e=>setSearchQuery(e.target.value)}/>
                                            <button onClick={()=>setSearchQuery('')} className="px-4 bg-white/10 rounded-xl">Ù…Ø³Ø­</button>
                                        </div>

                                        {/* Students List */}
                                        <div className="space-y-2 max-h-[500px] overflow-y-auto">
                                            {filteredStudents.map(s => {
                                                const daysLeft = calculateSubscriptionDays(dataState.subscriptions[s.id]?.endDate);
                                                const attendanceCount = Object.keys(dataState.attendance[s.id] || {}).length;
                                                const attendanceRank = calculateRank('attendance', attendanceCount);
                                                
                                                return (
                                                    <div key={s.id} className="flex flex-col md:flex-row justify-between items-start md:items-center bg-white/5 p-4 rounded-xl hover:bg-white/10 transition gap-3">
                                                        <div className="flex items-center gap-4 flex-1">
                                                            <div className="relative">
                                                                <img src={s.photo} className="w-12 h-12 rounded-full"/>
                                                                <div className={`absolute bottom-0 right-0 w-3 h-3 rounded-full ${s.isPaid?'bg-green-500':'bg-red-500'}`}></div>
                                                            </div>
                                                            <div>
                                                                <p className="font-bold">{s.name}</p>
                                                                <div className="flex gap-2 text-xs text-slate-400">
                                                                    <span className="font-mono bg-black/30 px-1 rounded">{s.code}</span>
                                                                    <span>|</span>
                                                                    <span>ğŸ“± {s.phone}</span>
                                                                    <span>|</span>
                                                                    <span>ğŸ“ {s.grade === '1sec' ? 'Ø£ÙˆÙ„' : s.grade === '2sec' ? 'Ø«Ø§Ù†ÙŠ' : 'Ø«Ø§Ù„Ø«'} Ø«Ø§Ù†ÙˆÙŠ</span>
                                                                    {s.isPaid && daysLeft > 0 && (
                                                                        <>
                                                                            <span>|</span>
                                                                            <span className="text-green-400">Ø¨Ø§Ù‚ÙŠ {daysLeft} ÙŠÙˆÙ…</span>
                                                                        </>
                                                                    )}
                                                                </div>
                                                                <div className="flex gap-2 mt-1">
                                                                    <div className="text-xs" style={{color: attendanceRank.color}}>
                                                                        <SafeIcon name="calendar-check" size={10} className="inline"/> {attendanceCount} ÙŠÙˆÙ…
                                                                    </div>
                                                                    {s.absences > 0 && (
                                                                        <div className="text-xs text-red-400">
                                                                            <SafeIcon name="x-circle" size={10} className="inline"/> {s.absences} ØºÙŠØ§Ø¨
                                                                        </div>
                                                                    )}
                                                                </div>
                                                                <div className="text-xs text-slate-500 mt-1">
                                                                    Ø£ÙŠØ§Ù… Ø§Ù„Ø­ØµØµ: {s.scheduleDays} | Ø§Ù„Ù…Ø±ÙƒØ²: {s.center}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div className="flex gap-2 flex-wrap">
                                                            <button onClick={()=>{setSelectedStudent(s); setShowStudentModal(true);}} 
                                                                    className="px-3 py-1 bg-blue-500/20 text-blue-400 rounded hover:bg-blue-500 hover:text-white transition text-sm">
                                                                Ø¥Ø¯Ø§Ø±Ø©
                                                            </button>
                                                            <button onClick={()=>{
                                                                // Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø±ØªØ¨Ø·ÙŠÙ†
                                                                const parents = dataState.parents.filter(p => 
                                                                    dataState.parentConnections[p.id]?.[s.id]
                                                                );
                                                                if (parents.length > 0) {
                                                                    alert(`Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø±ØªØ¨Ø·ÙŠÙ†:\n${parents.map(p => `- ${p.name} (${p.code})`).join('\n')}`);
                                                                } else {
                                                                    alert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø£Ù…ÙˆØ± Ù…Ø±ØªØ¨Ø·ÙŠÙ†');
                                                                }
                                                            }} 
                                                                    className="px-3 py-1 bg-purple-500/20 text-purple-400 rounded hover:bg-purple-500 hover:text-white transition text-sm">
                                                                Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
                                                            </button>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                )}

                                {/* Parents Tab */}
                                {activeTab === 'parents' && (
                                    <div>
                                        <h3 className="font-bold mb-4">Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ± Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</h3>
                                        <div className="space-y-3">
                                            {dataState.parents.map(parent => (
                                                <div key={parent.id} className="bg-white/5 p-4 rounded-xl">
                                                    <div className="flex justify-between items-start mb-3">
                                                        <div className="flex items-center gap-3">
                                                            <img src={parent.photo} className="w-12 h-12 rounded-full"/>
                                                            <div>
                                                                <p className="font-bold">{parent.name}</p>
                                                                <p className="text-xs text-slate-400">ğŸ“± {parent.phone} | {parent.relationship}</p>
                                                                <p className="text-xs text-slate-400 font-mono">{parent.code}</p>
                                                            </div>
                                                        </div>
                                                        <span className="badge-parent">ÙˆÙ„ÙŠ Ø£Ù…Ø±</span>
                                                    </div>
                                                    
                                                    {/* Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø±ØªØ¨Ø·ÙŠÙ† */}
                                                    <div className="mt-3">
                                                        <p className="text-sm text-slate-400 mb-2">Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø±ØªØ¨Ø·ÙŠÙ†:</p>
                                                        {dataState.parentConnections[parent.id] ? (
                                                            <div className="space-y-2">
                                                                {Object.keys(dataState.parentConnections[parent.id]).map(studentId => {
                                                                    const student = dataState.students.find(s => s.id === studentId);
                                                                    return student ? (
                                                                        <div key={studentId} className="flex justify-between items-center bg-black/20 p-2 rounded">
                                                                            <div className="flex items-center gap-2">
                                                                                <img src={student.photo} className="w-8 h-8 rounded-full"/>
                                                                                <div>
                                                                                    <p className="text-sm font-bold">{student.firstName} {student.secondName}</p>
                                                                                    <p className="text-xs text-slate-500">{student.code}</p>
                                                                                </div>
                                                                            </div>
                                                                            <span className="text-xs text-slate-400">
                                                                                {dataState.parentConnections[parent.id][studentId].relationship}
                                                                            </span>
                                                                        </div>
                                                                    ) : null;
                                                                })}
                                                            </div>
                                                        ) : (
                                                            <p className="text-sm text-slate-500">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø§Ø¨ Ù…Ø±ØªØ¨Ø·ÙŠÙ†</p>
                                                        )}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {/* Connections Tab */}
                                {activeTab === 'connections' && (
                                    <div>
                                        <h3 className="font-bold mb-4">Ø¥Ø¯Ø§Ø±Ø© Ø±ÙˆØ§Ø¨Ø· Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</h3>
                                        
                                        <div className="grid md:grid-cols-2 gap-6">
                                            {/* Ø±Ø¨Ø· Ø·Ø§Ù„Ø¨ Ø¨ÙˆÙ„ÙŠ Ø£Ù…Ø± */}
                                            <div className="glass-panel p-6">
                                                <h4 className="font-bold mb-4 text-green-400">Ø±Ø¨Ø· Ø·Ø§Ù„Ø¨ Ø¨ÙˆÙ„ÙŠ Ø£Ù…Ø±</h4>
                                                <div className="space-y-4">
                                                    <div>
                                                        <label className="block text-sm text-slate-400 mb-2">Ø§Ø®ØªØ± Ø§Ù„Ø·Ø§Ù„Ø¨</label>
                                                        <select id="connectStudent" className="w-full p-3 bg-white/5 border border-white/10 rounded-xl outline-none text-white">
                                                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø·Ø§Ù„Ø¨</option>
                                                            {dataState.students.map(s => (
                                                                <option key={s.id} value={s.id}>{s.name} - {s.code}</option>
                                                            ))}
                                                        </select>
                                                    </div>
                                                    
                                                    <div>
                                                        <label className="block text-sm text-slate-400 mb-2">Ø§Ø®ØªØ± ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</label>
                                                        <select id="connectParent" className="w-full p-3 bg-white/5 border border-white/10 rounded-xl outline-none text-white">
                                                            <option value="">Ø§Ø®ØªØ± ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</option>
                                                            {dataState.parents.map(p => (
                                                                <option key={p.id} value={p.id}>{p.name} - {p.code}</option>
                                                            ))}
                                                        </select>
                                                    </div>
                                                    
                                                    <div>
                                                        <label className="block text-sm text-slate-400 mb-2">Ø¹Ù„Ø§Ù‚Ø© Ø§Ù„Ù‚Ø±Ø§Ø¨Ø©</label>
                                                        <select id="connectRelationship" className="w-full p-3 bg-white/5 border border-white/10 rounded-xl outline-none text-white">
                                                            <option value="Ø§Ø¨Ù†/Ø§Ø¨Ù†Ø©">Ø§Ø¨Ù†/Ø§Ø¨Ù†Ø©</option>
                                                            <option value="Ø£Ø®/Ø£Ø®Øª">Ø£Ø®/Ø£Ø®Øª</option>
                                                            <option value="Ù‚Ø±ÙŠØ¨">Ù‚Ø±ÙŠØ¨</option>
                                                            <option value="ÙˆØµÙŠ">ÙˆØµÙŠ</option>
                                                        </select>
                                                    </div>
                                                    
                                                    <button onClick={()=>{
                                                        const studentId = document.getElementById('connectStudent').value;
                                                        const parentId = document.getElementById('connectParent').value;
                                                        const relationship = document.getElementById('connectRelationship').value;
                                                        
                                                        if (!studentId || !parentId) {
                                                            return showNotification('Ø§Ø®ØªØ± Ø§Ù„Ø·Ø§Ù„Ø¨ ÙˆÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±', 'error');
                                                        }
                                                        
                                                        linkStudentToParent(parentId, studentId, relationship);
                                                    }} className="btn-main w-full py-3">
                                                        Ø±Ø¨Ø·
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            {/* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· */}
                                            <div className="glass-panel p-6">
                                                <h4 className="font-bold mb-4 text-blue-400">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù†Ø´Ø·Ø©</h4>
                                                <div className="space-y-3 max-h-96 overflow-y-auto">
                                                    {dataState.parents.flatMap(parent => 
                                                        dataState.parentConnections[parent.id] ? 
                                                        Object.keys(dataState.parentConnections[parent.id]).map(studentId => {
                                                            const student = dataState.students.find(s => s.id === studentId);
                                                            if (!student) return null;
                                                            
                                                            return (
                                                                <div key={`${parent.id}-${studentId}`} className="flex justify-between items-center bg-black/20 p-3 rounded-lg">
                                                                    <div>
                                                                        <p className="font-bold text-sm">{student.firstName} {student.secondName}</p>
                                                                        <p className="text-xs text-slate-400">â† {parent.name}</p>
                                                                    </div>
                                                                    <div className="flex gap-2">
                                                                        <span className="text-xs text-slate-500">
                                                                            {dataState.parentConnections[parent.id][studentId].relationship}
                                                                        </span>
                                                                        <button onClick={()=>{
                                                                            if (confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ù„ØºØ§Ø¡ Ø±Ø¨Ø· ${student.firstName} Ù…Ø¹ ${parent.name}ØŸ`)) {
                                                                                window.rtdb.remove(window.rtdb.ref(window.db, `parentConnections/${parent.id}/${studentId}`));
                                                                                showNotification('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±Ø¨Ø·');
                                                                            }
                                                                        }} className="text-red-400 hover:text-red-300">
                                                                            <SafeIcon name="trash-2" size={16}/>
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            );
                                                        }) : []
                                                    ).filter(Boolean)}
                                                    
                                                    {dataState.parents.filter(p => dataState.parentConnections[p.id]).length === 0 && (
                                                        <p className="text-center text-slate-500 py-8">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· Ù†Ø´Ø·Ø©</p>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* Settings Tab */}
                                {activeTab === 'settings' && (
                                    <div>
                                        <h3 className="font-bold mb-4">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
                                        
                                        {user.role === 'boss' && (
                                            <div className="space-y-6">
                                                <div className="bg-red-500/10 border border-red-500/30 p-6 rounded-xl">
                                                    <h4 className="font-bold text-red-400 mb-4">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©</h4>
                                                    
                                                    <div className="space-y-4">
                                                        <button onClick={showAdminCodes} 
                                                                className="w-full bg-purple-600 hover:bg-purple-700 py-3 rounded-xl font-bold">
                                                            Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                                                        </button>
                                                        
                                                        <button onClick={()=>{
                                                            const newCodes = {
                                                                'BOSS': {
                                                                    code: generateRandomCode('BOSS'),
                                                                    role: 'boss',
                                                                    name: 'Ø§Ù„Ø¨ÙˆØµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ'
                                                                },
                                                                'ADMIN_1': {
                                                                    code: generateRandomCode('ADMIN'),
                                                                    role: 'admin',
                                                                    name: 'Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø£ÙˆÙ„'
                                                                },
                                                                'ADMIN_2': {
                                                                    code: generateRandomCode('ADMIN'),
                                                                    role: 'admin',
                                                                    name: 'Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø«Ø§Ù†ÙŠ'
                                                                },
                                                                'ADMIN_3': {
                                                                    code: generateRandomCode('ADMIN'),
                                                                    role: 'admin',
                                                                    name: 'Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø«Ø§Ù„Ø«'
                                                                }
                                                            };
                                                            
                                                            localStorage.setItem('ADMIN_CODES', JSON.stringify(newCodes));
                                                            showNotification('ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯ Ø¬Ø¯ÙŠØ¯Ø©. Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù„Ù… ØªØ¹Ø¯ ØµØ§Ù„Ø­Ø©.', 'success');
                                                        }} 
                                                                className="w-full bg-red-600 hover:bg-red-700 py-3 rounded-xl font-bold">
                                                            ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯ Ø¥Ø¯Ø§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©
                                                        </button>
                                                        
                                                        <div className="bg-black/30 p-4 rounded-lg">
                                                            <p className="text-sm text-slate-400 mb-2">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†:</p>
                                                            <ul className="text-xs text-slate-500 space-y-1">
                                                                <li>â€¢ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ ØªØªØºÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯ Ø¬Ø¯ÙŠØ¯Ø©</li>
                                                                <li>â€¢ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ØªØµØ¨Ø­ ØºÙŠØ± ØµØ§Ù„Ø­Ø© ÙÙˆØ±Ø§Ù‹</li>
                                                                <li>â€¢ Ù„Ø§ ØªØ´Ø§Ø±Ùƒ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ù…Ø¹ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ù„Ù‡Ù…</li>
                                                                <li>â€¢ Ù‚Ù… Ø¨ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯ Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ù†ØªØ¸Ø§Ù… Ù„Ù„Ø£Ù…Ø§Ù†</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        )}
                                        
                                        <div className="glass-panel p-6 mt-6">
                                            <h4 className="font-bold mb-4">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h4>
                                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                                <div className="bg-white/5 p-3 rounded text-center">
                                                    <div className="text-lg font-bold">{dataState.students.length}</div>
                                                    <div className="text-xs text-slate-400">Ø·Ø§Ù„Ø¨</div>
                                                </div>
                                                <div className="bg-white/5 p-3 rounded text-center">
                                                    <div className="text-lg font-bold">{dataState.parents.length}</div>
                                                    <div className="text-xs text-slate-400">ÙˆÙ„ÙŠ Ø£Ù…Ø±</div>
                                                </div>
                                                <div className="bg-white/5 p-3 rounded text-center">
                                                    <div className="text-lg font-bold">{dataState.lectures.length}</div>
                                                    <div className="text-xs text-slate-400">Ù…Ø­Ø§Ø¶Ø±Ø©</div>
                                                </div>
                                                <div className="bg-white/5 p-3 rounded text-center">
                                                    <div className="text-lg font-bold">{dataState.qa.length}</div>
                                                    <div className="text-xs text-slate-400">Ø³Ø¤Ø§Ù„</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Student Management Modal */}
                        {showStudentModal && selectedStudent && (
                            <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-4" onClick={()=>setShowStudentModal(false)}>
                                <div className="bg-brand-card p-6 rounded-2xl w-full max-w-lg border border-white/10 max-h-[90vh] overflow-y-auto" onClick={e=>e.stopPropagation()}>
                                    <h3 className="text-xl font-bold mb-4 text-brand-accent">Ø¥Ø¯Ø§Ø±Ø©: {selectedStudent.name}</h3>
                                    
                                    <div className="space-y-4">
                                        {/* Student Info */}
                                        <div className="grid grid-cols-2 gap-4 text-sm">
                                            <div>
                                                <p className="text-slate-400 text-xs mb-1">Ø§Ù„ÙƒÙˆØ¯:</p>
                                                <p className="font-bold">{selectedStudent.code}</p>
                                            </div>
                                            <div>
                                                <p className="text-slate-400 text-xs mb-1">Ø§Ù„ØµÙ:</p>
                                                <p className="font-bold">{selectedStudent.grade === '1sec' ? 'Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ' : selectedStudent.grade === '2sec' ? 'Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ' : 'Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ'}</p>
                                            </div>
                                            <div>
                                                <p className="text-slate-400 text-xs mb-1">Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</p>
                                                <p className="font-bold">{selectedStudent.phone}</p>
                                            </div>
                                            <div>
                                                <p className="text-slate-400 text-xs mb-1">Ø±Ù‚Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±:</p>
                                                <p className="font-bold">{selectedStudent.parentPhone}</p>
                                            </div>
                                        </div>

                                        {/* Notes */}
                                        <div>
                                            <label className="text-xs text-slate-400 mb-1 block">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ù„Ø¨:</label>
                                            <textarea 
                                                className="w-full bg-black/30 border border-white/10 rounded-lg p-2 text-white h-20" 
                                                value={selectedStudent.notes || ''} 
                                                onChange={e=>setSelectedStudent({...selectedStudent, notes: e.target.value})}
                                            />
                                        </div>

                                        {/* Status Controls */}
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <label className="text-xs text-slate-400 mb-1 block">Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹:</label>
                                                <button onClick={()=>{
                                                    const newState = !selectedStudent.isPaid;
                                                    updateStudent(selectedStudent.id, {isPaid: newState});
                                                    setSelectedStudent({...selectedStudent, isPaid: newState});
                                                }} className={`w-full px-4 py-2 rounded-lg font-bold ${selectedStudent.isPaid ? 'bg-green-500/20 text-green-400 border border-green-500/30' : 'bg-red-500/20 text-red-400 border border-red-500/30'}`}>
                                                    {selectedStudent.isPaid ? 'âœ“ Ù…ÙØ¹Ù„' : 'âœ— ØºÙŠØ± Ù…ÙØ¹Ù„'}
                                                </button>
                                            </div>
                                            <div>
                                                <label className="text-xs text-slate-400 mb-1 block">Ø§Ù„ØºÙŠØ§Ø¨:</label>
                                                <input 
                                                    type="number"
                                                    className="w-full bg-black/30 border border-white/10 rounded-lg p-2 text-white text-center"
                                                    value={selectedStudent.absences || 0}
                                                    onChange={e=>{
                                                        const value = parseInt(e.target.value) || 0;
                                                        setSelectedStudent({...selectedStudent, absences: value});
                                                    }}
                                                />
                                            </div>
                                        </div>

                                        {/* Add Subscription */}
                                        <div>
                                            <label className="text-xs text-slate-400 mb-1 block">Ø¥Ø¶Ø§ÙØ©/ØªØ¬Ø¯ÙŠØ¯ Ø§Ø´ØªØ±Ø§Ùƒ:</label>
                                            <div className="flex gap-2">
                                                <select id="subMonths" className="flex-1 bg-black/30 border border-white/10 rounded-lg p-2">
                                                    <option value="1">Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯</option>
                                                    <option value="2">Ø´Ù‡Ø±ÙŠÙ†</option>
                                                    <option value="3">3 Ø´Ù‡ÙˆØ±</option>
                                                    <option value="6">6 Ø´Ù‡ÙˆØ±</option>
                                                    <option value="12">Ø³Ù†Ø© ÙƒØ§Ù…Ù„Ø©</option>
                                                </select>
                                                <button onClick={()=>{
                                                    const months = parseInt(document.getElementById('subMonths').value);
                                                    addSubscription(selectedStudent.id, months);
                                                    setSelectedStudent({
                                                        ...selectedStudent,
                                                        isPaid: true
                                                    });
                                                }} className="bg-brand-accent text-brand-dark px-4 py-2 rounded-lg font-bold">Ø¥Ø¶Ø§ÙØ©</button>
                                            </div>
                                            {dataState.subscriptions[selectedStudent.id] && (
                                                <p className="text-xs text-green-400 mt-2">
                                                    Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ: Ø¨Ø§Ù‚ÙŠ {calculateSubscriptionDays(dataState.subscriptions[selectedStudent.id].endDate)} ÙŠÙˆÙ…
                                                </p>
                                            )}
                                        </div>

                                        {/* Ø±Ø¨Ø· Ù…Ø¹ ÙˆÙ„ÙŠ Ø£Ù…Ø± */}
                                        <div>
                                            <label className="text-xs text-slate-400 mb-1 block">Ø±Ø¨Ø· Ù…Ø¹ ÙˆÙ„ÙŠ Ø£Ù…Ø±:</label>
                                            <div className="flex gap-2">
                                                <select id="linkParentSelect" className="flex-1 bg-black/30 border border-white/10 rounded-lg p-2">
                                                    <option value="">Ø§Ø®ØªØ± ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</option>
                                                    {dataState.parents.map(p => (
                                                        <option key={p.id} value={p.id}>{p.name}</option>
                                                    ))}
                                                </select>
                                                <button onClick={()=>{
                                                    const parentId = document.getElementById('linkParentSelect').value;
                                                    if (!parentId) return showNotification('Ø§Ø®ØªØ± ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±', 'error');
                                                    
                                                    const parent = dataState.parents.find(p => p.id === parentId);
                                                    if (confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø±Ø¨Ø· ${selectedStudent.name} Ù…Ø¹ ${parent.name}ØŸ`)) {
                                                        linkStudentToParent(parentId, selectedStudent.id, 'Ø§Ø¨Ù†/Ø§Ø¨Ù†Ø©');
                                                    }
                                                }} className="bg-green-600 text-white px-4 py-2 rounded-lg font-bold">Ø±Ø¨Ø·</button>
                                            </div>
                                        </div>

                                        <div className="flex gap-2 pt-4">
                                            <button onClick={()=>{
                                                updateStudent(selectedStudent.id, {
                                                    notes: selectedStudent.notes,
                                                    absences: selectedStudent.absences || 0
                                                });
                                                showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª');
                                            }} className="flex-1 bg-brand-primary py-2 rounded-lg font-bold">Ø­ÙØ¸</button>
                                            <button onClick={()=>setShowStudentModal(false)} className="px-4 py-2 bg-white/10 rounded-lg font-bold">Ø¥ØºÙ„Ø§Ù‚</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                );
            }

            // ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù€ views (student-login, parent-login, guest, pending-approval, etc.) ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ Ù…Ø¹ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø·ÙÙŠÙØ©
            // Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø·ÙˆÙ„ Ø§Ù„Ø²Ø§Ø¦Ø¯ØŒ Ø³Ø£ØªØ±ÙƒÙ‡Ø§ ÙƒÙ…Ø§ Ù‡ÙŠ Ù…Ø¹ Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø¹Ù„Ù‰ Ø£Ù†Ù‡Ø§ ØªØ¹Ù…Ù„ Ø¨Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©

            return (
                <>
                    {notification && (
                        <div className={`fixed top-5 left-1/2 -translate-x-1/2 px-6 py-3 rounded-xl shadow-2xl font-bold z-[100] text-white flex items-center gap-2 ${notification.type==='error'?'bg-red-600':'bg-green-600'}`}>
                            <SafeIcon name={notification.type==='error'?'alert-circle':'check-circle'}/>
                            {notification.message}
                        </div>
                    )}
                </>
            );
        };

        const RootApp = () => (
            <ErrorBoundary>
                <App />
            </ErrorBoundary>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<RootApp />);
    </script>
    
    <!-- Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨Ø³Ø· -->
    <script>
        class SimpleAdminSystem {
            constructor() {
                this.init();
            }
            
            init() {
                // Ø²Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©
                this.addAdminButton();
                
                // Ø§Ø®ØªØµØ§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
                this.addKeyboardShortcut();
                
                // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚
                this.checkPreviousLogin();
            }
            
            addAdminButton() {
                setTimeout(() => {
                    const btn = document.createElement('div');
                    btn.innerHTML = 'ğŸ›¡ï¸';
                    btn.title = 'Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©';
                    btn.style.cssText = `
                        position: fixed;
                        bottom: 60px;
                        right: 10px;
                        width: 40px;
                        height: 40px;
                        background: rgba(239, 68, 68, 0.2);
                        border: 1px solid rgba(239, 68, 68, 0.4);
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        cursor: pointer;
                        z-index: 9998;
                        font-size: 18px;
                        opacity: 0.5;
                        transition: all 0.3s;
                    `;
                    
                    btn.onmouseenter = () => {
                        btn.style.opacity = '1';
                        btn.style.background = 'rgba(239, 68, 68, 0.4)';
                        btn.style.transform = 'scale(1.1)';
                    };
                    
                    btn.onmouseleave = () => {
                        btn.style.opacity = '0.5';
                        btn.style.background = 'rgba(239, 68, 68, 0.2)';
                        btn.style.transform = 'scale(1)';
                    };
                    
                    btn.onclick = () => this.showAdminAccess();
                    
                    document.body.appendChild(btn);
                }, 3000);
            }
            
            showAdminAccess() {
                const action = prompt('Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡:\n1. Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (ØªØ³Ø¬ÙŠÙ„ Ø¬ÙˆØ¬Ù„ Ù…Ø·Ù„ÙˆØ¨)\n2. Ø¹Ø±Ø¶ Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©\n3. ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯ Ø¬Ø¯ÙŠØ¯Ø©\n\nØ£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù…:', '1');
                
                switch(action) {
                    case '1':
                        this.loginAsAdmin();
                        break;
                    case '2':
                        this.showCurrentCodes();
                        break;
                    case '3':
                        this.generateNewCodes();
                        break;
                    default:
                        break;
                }
            }
            
            loginAsAdmin() {
                const code = prompt('Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:', '');
                if (!code) return;
                
                // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£ÙƒÙˆØ§Ø¯
                const savedCodes = JSON.parse(localStorage.getItem('ADMIN_CODES') || '{}');
                let validCode = null;
                
                Object.values(savedCodes).forEach(admin => {
                    if (admin.code === code) {
                        validCode = admin;
                    }
                });
                
                if (validCode) {
                    // ØªØ³Ø¬ÙŠÙ„ Ø¬ÙˆØ¬Ù„ Ø£ÙˆÙ„Ø§Ù‹
                    if (!window.auth?.currentUser) {
                        alert('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø­Ø³Ø§Ø¨ Ø¬ÙˆØ¬Ù„ Ø£ÙˆÙ„Ø§Ù‹');
                        window.authMethods.signInWithPopup(window.auth, window.googleProvider)
                            .then(() => {
                                setTimeout(() => {
                                    this.completeAdminLogin(validCode);
                                }, 1000);
                            });
                    } else {
                        this.completeAdminLogin(validCode);
                    }
                } else {
                    alert('âŒ Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­');
                }
            }
            
            completeAdminLogin(adminData) {
                const user = window.auth.currentUser;
                
                // Ø­ÙØ¸ ÙÙŠ Firebase
                window.rtdb.set(window.rtdb.ref(window.db, 'users/' + user.uid), {
                    uid: user.uid,
                    email: user.email,
                    name: user.displayName || adminData.name,
                    photo: user.photoURL,
                    role: adminData.role,
                    adminLevel: adminData.name,
                    isNew: false,
                    joinedAt: new Date().toISOString()
                });
                
                // Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ
                localStorage.setItem('admin_logged_in', 'true');
                localStorage.setItem('admin_role', adminData.role);
                localStorage.setItem('admin_name', adminData.name);
                
                alert(`âœ… ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ€ ${adminData.name}\n\nØ¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…...`);
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„
                setTimeout(() => window.location.reload(), 1000);
            }
            
            showCurrentCodes() {
                const savedCodes = JSON.parse(localStorage.getItem('ADMIN_CODES') || '{}');
                let message = 'ğŸ” **Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:**\n\n';
                
                Object.values(savedCodes).forEach((admin, idx) => {
                    message += `${idx + 1}. ${admin.name}\n`;
                    message += `   Ø§Ù„ÙƒÙˆØ¯: **${admin.code}**\n`;
                    message += `   Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©: ${admin.role}\n\n`;
                });
                
                alert(message);
            }
            
            generateNewCodes() {
                if (!confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ\n\nÙ‡Ø°Ø§ Ø³ÙŠÙˆÙ„Ø¯ Ø£ÙƒÙˆØ§Ø¯ Ø¬Ø¯ÙŠØ¯Ø© ÙˆÙŠØ¬Ø¹Ù„ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©.')) {
                    return;
                }
                
                const newCodes = {
                    'BOSS': {
                        code: 'BOSS-' + Math.random().toString(36).substr(2, 8).toUpperCase(),
                        role: 'boss',
                        name: 'Ø§Ù„Ø¨ÙˆØµ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ'
                    },
                    'ADMIN_1': {
                        code: 'ADMIN-' + Math.random().toString(36).substr(2, 8).toUpperCase(),
                        role: 'admin',
                        name: 'Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø£ÙˆÙ„'
                    },
                    'ADMIN_2': {
                        code: 'ADMIN-' + Math.random().toString(36).substr(2, 8).toUpperCase(),
                        role: 'admin',
                        name: 'Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø«Ø§Ù†ÙŠ'
                    },
                    'ADMIN_3': {
                        code: 'ADMIN-' + Math.random().toString(36).substr(2, 8).toUpperCase(),
                        role: 'admin',
                        name: 'Ø§Ù„Ø£Ø¯Ù…Ù† Ø§Ù„Ø«Ø§Ù„Ø«'
                    }
                };
                
                localStorage.setItem('ADMIN_CODES', JSON.stringify(newCodes));
                
                let message = 'âœ… **ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯ Ø¬Ø¯ÙŠØ¯Ø©:**\n\n';
                Object.values(newCodes).forEach((admin, idx) => {
                    message += `${idx + 1}. ${admin.name}\n`;
                    message += `   Ø§Ù„ÙƒÙˆØ¯: **${admin.code}**\n\n`;
                });
                
                alert(message + '\nâš ï¸ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù„Ù… ØªØ¹Ø¯ ØµØ§Ù„Ø­Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù….');
            }
            
            addKeyboardShortcut() {
                document.addEventListener('keydown', (e) => {
                    // Ctrl+Alt+A
                    if (e.ctrlKey && e.altKey && e.key === 'a') {
                        e.preventDefault();
                        this.showAdminAccess();
                    }
                });
            }
            
            checkPreviousLogin() {
                if (localStorage.getItem('admin_logged_in') === 'true') {
                    console.log('âœ… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø¥Ø¯Ø§Ø±ÙŠ Ù…Ø³Ø¨Ù‚Ø§Ù‹');
                }
            }
        }
        
        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                window.AdminSystem = new SimpleAdminSystem();
            }, 2000);
        });
    </script>
</body>
</html>